!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("forgerock",[],t):"object"==typeof exports?exports.forgerock=t():e.forgerock=t()}(window,function(){return r={},o.m=n=[function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(o.prototype.getType=function(){return this.payload.type},o.prototype.getInputValue=function(e){return void 0===e&&(e=0),this.getArrayElement(this.payload.input,e).value},o.prototype.setInputValue=function(e,t){void 0===t&&(t=0),this.getArrayElement(this.payload.input,t).value=e},o.prototype.getOutputValue=function(e){return void 0===e&&(e=0),this.getArrayElement(this.payload.output,e).value},o.prototype.getOutputByName=function(t,e){var n=this.payload.output.find(function(e){return e.name===t});return n?n.value:e},o.prototype.getArrayElement=function(e,t){if(void 0===t&&(t=0),void 0===e)throw new Error("No NameValue array was provided to search (selector "+t+")");if("number"==typeof t){if(t<0||t>e.length-1)throw new Error("Selector index "+t+" is out of range");return e[t]}if("string"!=typeof t)throw new Error("Invalid selector value type");var n=e.find(function(e){return e.name===t});if(!n)throw new Error('Missing callback input entry "'+t+'"');return n},o);function o(e){this.payload=e}t.default=r},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(40);t.DEFAULT_TIMEOUT=o.DEFAULT_TIMEOUT;var i=(a.set=function(e){if(!this.isValid(e))throw new Error("Configuration is invalid");e.serverConfig&&this.validateServerConfig(e.serverConfig),this.options=r({},e)},a.get=function(e){if(!this.options&&!e)throw new Error("Configuration has not been set");var t=r(r({},this.options),e);if(!t.serverConfig||!t.serverConfig.baseUrl)throw new Error("Server configuration has not been set");return t},a.isValid=function(e){return!(!e||!e.serverConfig)},a.validateServerConfig=function(e){e.timeout||(e.timeout=o.DEFAULT_TIMEOUT);var t=e.baseUrl;t&&"/"!==t.charAt(t.length-1)&&(e.baseUrl=t+"/")},a);function a(){}t.default=i},function(e,t,n){"use strict";var a=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var i=n(41);function u(e){var t="http:"===e.protocol&&-1===["","80"].indexOf(e.port)||"https:"===e.protocol&&-1===["","443"].indexOf(e.port)?":"+e.port:"";return e.protocol+"//"+e.hostname+t}t.getBaseUrl=u,t.getEndpointPath=function(e,t,n){var r=i.getRealmUrlPath(t),o={authenticate:"json/"+r+"/authenticate",authorize:"oauth2/"+r+"/authorize",accessToken:"oauth2/"+r+"/access_token",endSession:"oauth2/"+r+"/connect/endSession",userInfo:"oauth2/"+r+"/userinfo",revoke:"oauth2/"+r+"/token/revoke",sessions:"json/"+r+"/sessions/"};return n&&n[e]?n[e]:o[e]},t.resolve=function(e,t){var n=new URL(e);if(t.startsWith("/"))return""+u(n)+t;var r=n.pathname.split("/"),o=t.split("/").filter(function(e){return!!e}),i=a(r.slice(0,-1),o).join("/");return""+u(n)+i},t.parseQuery=function(e){var t=new URL(e),n={};return t.searchParams.forEach(function(e,t){return n[t]=e}),n},t.stringify=function(e){var t=[];for(var n in e)e[n]&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}},function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),(o=r=r||{}).LoginFailure="LoginFailure",o.LoginSuccess="LoginSuccess",o.Step="Step",t.StepType=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.withTimeout=function(e,t){void 0===t&&(t=r.DEFAULT_TIMEOUT);var n=t||r.DEFAULT_TIMEOUT;return Promise.race([e,new Promise(function(e,t){return window.setTimeout(function(){return t(new Error("Timeout"))},n)})])}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},p=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=o(n(1)),c=o(n(6)),a=n(36),f=o(n(9)),l=n(4),h=n(2),i=n(52);t.ResponseType=i.ResponseType;var u=(s.getAuthorizeUrl=function(l){return r(this,void 0,void 0,function(){var t,u,n,r,o,i,a,s,c=this;return p(this,function(e){switch(e.label){case 0:return t=d.default.get(l),u=t.serverConfig,n=t.clientId,r=t.redirectUri,o=t.scope,i={client_id:n,redirect_uri:r,response_type:l.responseType,scope:o,state:l.state},l.verifier?[4,f.default.createChallenge(l.verifier)]:[3,2];case 1:a=e.sent(),i.code_challenge=a,i.code_challenge_method="S256",e.label=2;case 2:return s=this.getUrl("authorize",i,l),[2,new Promise(function(t,e){function n(){}var r,o=document.createElement("iframe"),i=n,a=0;r=function(){window.clearTimeout(a),o.removeEventListener("load",i),o.remove()},i=function(){if(o.contentWindow){var e=o.contentWindow.location.href;c.containsAuthCode(e)&&(r(),t(e))}},a=window.setTimeout(function(){r(),e("Timeout")},u.timeout),o.style.display="none",o.addEventListener("load",i),document.body.appendChild(o),o.src=s})]}})})},s.getOAuth2Tokens=function(f){return r(this,void 0,void 0,function(){var t,n,r,o,i,a,u,s,c,l;return p(this,function(e){switch(e.label){case 0:return t=d.default.get(f),n=t.clientId,r=t.redirectUri,o={client_id:n,code:f.authorizationCode,grant_type:"authorization_code",redirect_uri:r},f.verifier&&(o.code_verifier=f.verifier),i=h.stringify(o),a={body:i,headers:{"content-length":i.length.toString(),"content-type":"application/x-www-form-urlencoded"},method:"POST"},[4,this.request("accessToken",void 0,!1,a,f)];case 1:return u=e.sent(),[4,this.getBody(u)];case 2:if(s=e.sent(),200!==u.status)throw c="string"==typeof s?"Expected 200, received "+u.status:this.parseError(s),new Error(c);if(!(l=s).access_token)throw new Error("Access token not found in response");return[2,{accessToken:l.access_token,idToken:l.id_token,refreshToken:l.refresh_token}]}})})},s.getUserInfo=function(n){return r(this,void 0,void 0,function(){var t;return p(this,function(e){switch(e.label){case 0:return[4,this.request("userInfo",void 0,!0,void 0,n)];case 1:if(200!==(t=e.sent()).status)throw new Error("Failed to get user info; received "+t.status);return[4,t.json()];case 2:return[2,e.sent()]}})})},s.endSession=function(o){return r(this,void 0,void 0,function(){var t,n,r;return p(this,function(e){switch(e.label){case 0:return[4,c.default.get()];case 1:return t=e.sent().idToken,n={},t&&(n.id_token_hint=t),[4,this.request("endSession",n,!0,void 0,o)];case 2:if(r=e.sent(),!a.isOkOr4xx(r))throw new Error("Failed to end session; received "+r.status);return[2,r]}})})},s.revokeToken=function(i){return r(this,void 0,void 0,function(){var t,n,r,o;return p(this,function(e){switch(e.label){case 0:return t=d.default.get(i).clientId,[4,c.default.get()];case 1:return n=e.sent().accessToken,r={body:h.stringify({client_id:t,token:n}),credentials:"include",headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST"},[4,this.request("revoke",void 0,!1,r,i)];case 2:if(o=e.sent(),!a.isOkOr4xx(o))throw new Error("Failed to revoke token; received "+o.status);return[2,o]}})})},s.request=function(o,i,a,u,s){return r(this,void 0,void 0,function(){var t,n,r;return p(this,function(e){switch(e.label){case 0:return t=d.default.get(s).serverConfig,n=this.getUrl(o,i,s),u=u||{},a?[4,c.default.get()]:[3,2];case 1:r=e.sent().accessToken,u.credentials="include",u.headers=u.headers||new Headers,u.headers.set("authorization","Bearer "+r),e.label=2;case 2:return[4,l.withTimeout(fetch(n,u),t.timeout)];case 3:return[2,e.sent()]}})})},s.containsAuthCode=function(e){return!!e&&/code=([^&]+)/.test(e)},s.getBody=function(n){return r(this,void 0,void 0,function(){var t;return p(this,function(e){switch(e.label){case 0:return(t=n.headers.get("content-type"))&&-1<t.indexOf("application/json")?[4,n.json()]:[3,2];case 1:return[2,e.sent()];case 2:return[4,n.text()];case 3:return[2,e.sent()]}})})},s.parseError=function(e){if(e){if(e.error&&e.error_description)return e.error+": "+e.error_description;if(e.code&&e.message)return e.code+": "+e.message}},s.getUrl=function(e,t,n){var r=d.default.get(n),o=r.realmPath,i=r.serverConfig,a=h.getEndpointPath(e,o,i.paths),u=h.resolve(i.baseUrl,a);return t&&(u+="?"+h.stringify(t)),u},s);function s(){}t.default=u},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},i=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(1)),u=o(n(50)),s=o(n(51)),c=(l.get=function(){return r(this,void 0,void 0,function(){var t,n,r;return i(this,function(e){switch(e.label){case 0:return t=this.getClientConfig(),n=t.clientId,"localStorage"!==(r=t.tokenStore)?[3,2]:[4,s.default.get(n)];case 1:return[2,e.sent()];case 2:return"indexedDB"!==r?[3,4]:[4,u.default.get(n)];case 3:return[2,e.sent()];case 4:return r&&r.get?[4,r.get(n)]:[3,6];case 5:return[2,e.sent()];case 6:return[4,u.default.get(n)];case 7:return[2,e.sent()]}})})},l.set=function(o){return r(this,void 0,void 0,function(){var t,n,r;return i(this,function(e){switch(e.label){case 0:return t=this.getClientConfig(),n=t.clientId,"localStorage"!==(r=t.tokenStore)?[3,2]:[4,s.default.set(n,o)];case 1:return[2,e.sent()];case 2:return"indexedDB"!==r?[3,4]:[4,u.default.set(n,o)];case 3:return[2,e.sent()];case 4:return r&&r.set?[4,r.set(n,o)]:[3,6];case 5:return[2,e.sent()];case 6:return[4,u.default.set(n,o)];case 7:return[2,e.sent()]}})})},l.remove=function(){return r(this,void 0,void 0,function(){var t,n,r;return i(this,function(e){switch(e.label){case 0:return t=this.getClientConfig(),n=t.clientId,"localStorage"!==(r=t.tokenStore)?[3,2]:[4,s.default.remove(n)];case 1:return[2,e.sent()];case 2:return"indexedDB"!==r?[3,4]:[4,u.default.remove(n)];case 3:return[2,e.sent()];case 4:return r&&r.remove?[4,r.remove(n)]:[3,6];case 5:return[2,e.sent()];case 6:return[4,u.default.remove(n)];case 7:return[2,e.sent()]}})})},l.getClientConfig=function(){var e=a.default.get(),t=e.clientId,n=e.tokenStore;if(!t)throw new Error("clientId is required to manage token storage");return{clientId:t,tokenStore:n}},l);function l(){}t.default=c},function(e,t,n){"use strict";var r,o,i,a;Object.defineProperty(t,"__esModule",{value:!0}),(o=r=r||{}).BadRequest="BAD_REQUEST",o.Timeout="TIMEOUT",o.Unauthorized="UNAUTHORIZED",o.Unknown="UNKNOWN",t.ErrorCode=r,(a=i=i||{}).BooleanAttributeInputCallback="BooleanAttributeInputCallback",a.ChoiceCallback="ChoiceCallback",a.ConfirmationCallback="ConfirmationCallback",a.DeviceProfileCallback="DeviceProfileCallback",a.HiddenValueCallback="HiddenValueCallback",a.KbaCreateCallback="KbaCreateCallback",a.MetadataCallback="MetadataCallback",a.NameCallback="NameCallback",a.PasswordCallback="PasswordCallback",a.PollingWaitCallback="PollingWaitCallback",a.ReCaptchaCallback="ReCaptchaCallback",a.StringAttributeInputCallback="StringAttributeInputCallback",a.TermsAndConditionsCallback="TermsAndConditionsCallback",a.TextOutputCallback="TextOutputCallback",a.ValidatedCreatePasswordCallback="ValidatedCreatePasswordCallback",a.ValidatedCreateUsernameCallback="ValidatedCreateUsernameCallback",t.CallbackType=i},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(45)),i=n(3),a=(u.prototype.getCallbackOfType=function(e){var t=this.getCallbacksOfType(e);if(1!==t.length)throw new Error('Expected 1 callback of type "'+e+'", but found '+t.length);return t[0]},u.prototype.getCallbacksOfType=function(t){return this.callbacks.filter(function(e){return e.getType()===t})},u.prototype.setCallbackValue=function(e,t){var n=this.getCallbacksOfType(e);if(1!==n.length)throw new Error('Expected 1 callback of type "'+e+'", but found '+n.length);n[0].setInputValue(t)},u.prototype.getDescription=function(){return this.payload.description},u.prototype.getHeader=function(){return this.payload.header},u.prototype.getStage=function(){return this.payload.stage},u.prototype.convertCallbacks=function(e,t){return e.map(function(e){return(t||o.default)(e)||o.default(e)})},u);function u(e,t){this.payload=e,this.type=i.StepType.Step,this.callbacks=[],e.callbacks&&(this.callbacks=this.convertCallbacks(e.callbacks,t))}t.default=a},function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},i=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0});var r=(a.createVerifier=function(e){void 0===e&&(e=32);var t=new Uint8Array(e);return window.crypto.getRandomValues(t),this.base64UrlEncode(t)},a.createChallenge=function(n){return o(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return[4,this.sha256(n)];case 1:return t=e.sent(),[2,this.base64UrlEncode(t)]}})})},a.base64UrlEncode=function(e){var t=Array.prototype.slice.call(e);return window.btoa(String.fromCharCode.apply(null,t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},a.sha256=function(r){return o(this,void 0,void 0,function(){var t,n;return i(this,function(e){switch(e.label){case 0:return t=(new TextEncoder).encode(r),[4,window.crypto.subtle.digest("SHA-256",t)];case 1:return n=e.sent(),[2,new Uint8Array(n)]}})})},a);function a(){}t.default=r},function(e,t,n){"use strict";var p=this&&this.__assign||function(){return(p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},d=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=o(n(5)),y=i(n(6)),v=i(n(37)),b=i(n(9)),_=n(2),a=(u.getTokens=function(f){return r(this,void 0,void 0,function(){var t,n,r,o,i,a,u,s,c,l;return d(this,function(e){switch(e.label){case 0:if(f&&f.forceRenew)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,y.default.get()];case 2:return(t=e.sent())?[2,t]:[3,4];case 3:return n=e.sent(),console.error("Failed to retrieve stored tokens",n),[3,4];case 4:return r=b.default.createVerifier(),o=v.default()().toString(),i=p(p({},f),{responseType:h.ResponseType.Code,state:o,verifier:r}),[4,h.default.getAuthorizeUrl(i)];case 5:if(a=e.sent(),(u=_.parseQuery(a)).state!==o)throw new Error("State mismatch");if(!u.code||Array.isArray(u.code))throw new Error("Failed to acquire authorization code");return s=u.code,c=p(p({},f),{authorizationCode:s,verifier:r}),[4,h.default.getOAuth2Tokens(c)];case 6:t=e.sent(),e.label=7;case 7:return e.trys.push([7,9,,10]),[4,y.default.set(t)];case 8:return e.sent(),[3,10];case 9:return l=e.sent(),console.error("Failed to store tokens",l),[3,10];case 10:return[2,t]}})})},u.deleteTokens=function(){return r(this,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return[4,y.default.remove()];case 1:return e.sent(),[2]}})})},u);function u(){}t.default=a},function(e,t,n){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},f=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var p=r(n(1)),i=n(12),d=n(4),c=n(2),a=(u.next=function(c,l){return o(this,void 0,void 0,function(){var t,n,r,o,i,a,u,s;return f(this,function(e){switch(e.label){case 0:return t=p.default.get(l),n=t.realmPath,r=t.serverConfig,o=t.tree,i=l?l.query:{},a=this.constructUrl(r,n,o,i),u=this.configureRequest(c),[4,d.withTimeout(fetch(a,u),r.timeout)];case 1:return s=e.sent(),[4,this.getResponseJson(s)];case 2:return[2,e.sent()]}})})},u.constructUrl=function(e,t,n,r){var o=n?{authIndexType:"service",authIndexValue:n}:void 0,i=s(s({},r),o),a=0<Object.keys(i).length?"?"+c.stringify(i):"",u=c.getEndpointPath("authenticate",t,e.paths);return c.resolve(e.baseUrl,u+a)},u.configureRequest=function(e){return{body:e?JSON.stringify(e):void 0,credentials:"include",headers:{accept:"application/json","accept-api-version":"protocol=1.0,resource=2.1","content-type":"application/json","x-requested-with":i.REQUESTED_WITH},method:"POST"}},u.getResponseJson=function(r){return o(this,void 0,void 0,function(){var t,n;return f(this,function(e){switch(e.label){case 0:return(t=r.headers.get("content-type"))&&-1<t.indexOf("application/json")?[4,r.json()]:[3,2];case 1:return n=e.sent(),[3,3];case 2:n=void 0,e.label=3;case 3:return[2,n]}})})},u);function u(){}t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.REQUESTED_WITH="forgerock-sdk"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42),o=(i.prototype.addEventListener=function(e,t){r.add(this.callbacks,e,t)},i.prototype.removeEventListener=function(e,t){r.remove(this.callbacks,e,t)},i.prototype.clearEventListeners=function(e){r.clear(this.callbacks,e)},i.prototype.dispatchEvent=function(e){if(this.callbacks[e.type])for(var t=0,n=this.callbacks[e.type];t<n.length;t++)(0,n[t])(e)},i);function i(){this.callbacks={}}t.default=o},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},a=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=r(n(11)),s=r(n(15)),c=r(n(19)),l=r(n(8)),o=(f.next=function(r,o){return i(this,void 0,void 0,function(){var t,n;return a(this,function(e){switch(e.label){case 0:return[4,u.default.next(r?r.payload:void 0,o)];case 1:return(t=e.sent()).tokenId?[2,new c.default(t)]:t.authId?(n=o?o.callbackFactory:void 0,[2,new l.default(t,n)]):[2,new s.default(t)]}})})},f);function f(){}t.default=o},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(16)),i=n(3),a=(u.prototype.getCode=function(){return Number(this.payload.code)},u.prototype.getDetail=function(){return this.payload.detail},u.prototype.getMessage=function(){return this.payload.message},u.prototype.getProcessedMessage=function(e){return o.default.parseErrors(this.payload,e)},u.prototype.getReason=function(){return this.payload.reason},u);function u(e){this.payload=e,this.type=i.StepType.LoginFailure}t.default=a},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(17);t.PolicyKey=a.PolicyKey;var u=r(n(18)),o=(s.parseErrors=function(e,t){var n=this,r=[];return e.detail&&e.detail.failedPolicyRequirements&&e.detail.failedPolicyRequirements.map(function(e){r.push.apply(r,[{detail:e,messages:n.parseFailedPolicyRequirement(e,t)}])}),r},s.parseFailedPolicyRequirement=function(t,n){var r=this,o=[];return t.policyRequirements.map(function(e){o.push(r.parsePolicyRequirement(t.property,e,n))}),o},s.parsePolicyRequirement=function(e,t,n){void 0===n&&(n={});var r="string"==typeof t?JSON.parse(t):i({},t),o=r.policyRequirement;return(n[o]||u.default[o]||u.default[a.PolicyKey.UnknownPolicy])(e,r.params?i(i({},r.params),{policyRequirement:o}):{policyRequirement:o})},s);function s(){}t.default=o},function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),(o=r=r||{}).CannotContainCharacters="CANNOT_CONTAIN_CHARACTERS",o.CannotContainDuplicates="CANNOT_CONTAIN_DUPLICATES",o.CannotContainOthers="CANNOT_CONTAIN_OTHERS",o.LeastCapitalLetters="AT_LEAST_X_CAPITAL_LETTERS",o.LeastNumbers="AT_LEAST_X_NUMBERS",o.MatchRegexp="MATCH_REGEXP",o.MaximumLength="MAX_LENGTH",o.MaximumNumber="MAXIMUM_NUMBER_VALUE",o.MinimumLength="MIN_LENGTH",o.MinimumNumber="MINIMUM_NUMBER_VALUE",o.Required="REQUIRED",o.Unique="UNIQUE",o.UnknownPolicy="UNKNOWN_POLICY",o.ValidArrayItems="VALID_ARRAY_ITEMS",o.ValidDate="VALID_DATE",o.ValidEmailAddress="VALID_EMAIL_ADDRESS_FORMAT",o.ValidNameFormat="VALID_NAME_FORMAT",o.ValidNumber="VALID_NUMBER",o.ValidPhoneFormat="VALID_PHONE_FORMAT",o.ValidQueryFilter="VALID_QUERY_FILTER",o.ValidType="VALID_TYPE",t.PolicyKey=r},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var o=n(43),i=n(17),a=n(44),u=((r={})[i.PolicyKey.CannotContainCharacters]=function(e,t){return e+' must not contain following characters: "'+a.getProp(t,"forbiddenChars","")+'"'},r[i.PolicyKey.CannotContainDuplicates]=function(e,t){return e+'  must not contain duplicates: "'+a.getProp(t,"duplicateValue","")+'"'},r[i.PolicyKey.CannotContainOthers]=function(e,t){return e+' must not contain: "'+a.getProp(t,"disallowedFields","")+'"'},r[i.PolicyKey.LeastCapitalLetters]=function(e,t){var n=a.getProp(t,"numCaps",0);return e+" must contain at least "+n+" capital "+o.plural(n,"letter")},r[i.PolicyKey.LeastNumbers]=function(e,t){var n=a.getProp(t,"numNums",0);return e+" must contain at least "+n+" numeric "+o.plural(n,"value")},r[i.PolicyKey.MatchRegexp]=function(e){return e+' has failed the "MATCH_REGEXP" policy'},r[i.PolicyKey.MaximumLength]=function(e,t){var n=a.getProp(t,"maxLength",0);return e+" must be at most "+n+" "+o.plural(n,"character")},r[i.PolicyKey.MaximumNumber]=function(e){return e+' has failed the "MAXIMUM_NUMBER_VALUE" policy'},r[i.PolicyKey.MinimumLength]=function(e,t){var n=a.getProp(t,"minLength",0);return e+" must be at least "+n+" "+o.plural(n,"character")},r[i.PolicyKey.MinimumNumber]=function(e){return e+' has failed the "MINIMUM_NUMBER_VALUE" policy'},r[i.PolicyKey.Required]=function(e){return e+" is required"},r[i.PolicyKey.Unique]=function(e){return e+" must be unique"},r[i.PolicyKey.UnknownPolicy]=function(e,t){return e+': Unknown policy requirement "'+a.getProp(t,"policyRequirement","Unknown")+'"'},r[i.PolicyKey.ValidArrayItems]=function(e){return e+' has failed the "VALID_ARRAY_ITEMS" policy'},r[i.PolicyKey.ValidDate]=function(e){return e+" has an invalid date"},r[i.PolicyKey.ValidEmailAddress]=function(e){return e+" has an invalid email address"},r[i.PolicyKey.ValidNameFormat]=function(e){return e+" has an invalid name format"},r[i.PolicyKey.ValidNumber]=function(e){return e+" has an invalid number"},r[i.PolicyKey.ValidPhoneFormat]=function(e){return e+" has an invalid phone number"},r[i.PolicyKey.ValidQueryFilter]=function(e){return e+' has failed the "VALID_QUERY_FILTER" policy'},r[i.PolicyKey.ValidType]=function(e){return e+' has failed the "VALID_TYPE" policy'},r);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=(i.prototype.getRealm=function(){return this.payload.realm},i.prototype.getSessionToken=function(){return this.payload.tokenId},i.prototype.getSuccessUrl=function(){return this.payload.successUrl},i);function i(e){this.payload=e,this.type=r.StepType.LoginSuccess}t.default=o},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getName=function(){return this.getOutputByName("name","")},c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.isRequired=function(){return this.getOutputByName("required",!1)},c.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},c.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},c.prototype.setValue=function(e){this.setInputValue(e)},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.getDefaultChoice=function(){return this.getOutputByName("defaultChoice",0)},c.prototype.getChoices=function(){return this.getOutputByName("choices",[])},c.prototype.setChoiceIndex=function(e){var t=this.getChoices().length;if(e<0||t-1<e)throw new Error(e+" is out of bounds");this.setInputValue(e)},c.prototype.setChoiceValue=function(e){var t=this.getChoices().indexOf(e);if(-1===t)throw new Error('"'+e+'" is not a valid choice');this.setInputValue(t)},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getDefaultOption=function(){return Number(this.getOutputByName("defaultOption",0))},c.prototype.getMessageType=function(){return Number(this.getOutputByName("messageType",0))},c.prototype.getOptions=function(){return this.getOutputByName("options",[])},c.prototype.getOptionType=function(){return Number(this.getOutputByName("optionType",0))},c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getMessage=function(){return this.getOutputByName("message","")},c.prototype.isMetadataRequired=function(){return this.getOutputByName("metadata",!1)},c.prototype.isLocationRequired=function(){return this.getOutputByName("location",!1)},c.prototype.setProfile=function(e){this.setInputValue(JSON.stringify(e))},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.getPredefinedQuestions=function(){return this.getOutputByName("predefinedQuestions",[])},c.prototype.setQuestion=function(e){this.setValue("question",e)},c.prototype.setAnswer=function(e){this.setValue("answer",e)},c.prototype.setValue=function(t,e){if(!this.payload.input)throw new Error("KBA payload is missing input");var n=this.payload.input.find(function(e){return e.name.endsWith(t)});if(!n)throw new Error('No input has name ending in "'+t+'"');n.value=e},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getData=function(){return this.getOutputByName("data",{})},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.setName=function(e){this.setInputValue(e)},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},c.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.setPassword=function(e){this.setInputValue(e)},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getMessage=function(){return this.getOutputByName("message","")},c.prototype.getWaitTime=function(){return Number(this.getOutputByName("waitTime",0))},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getSiteKey=function(){return this.getOutputByName("recaptchaSiteKey","")},c.prototype.setResult=function(e){this.setInputValue(e)},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getTerms=function(){return this.getOutputByName("terms","")},c.prototype.getVersion=function(){return this.getOutputByName("version","")},c.prototype.getCreateDate=function(){var e=this.getOutputByName("createDate","");return new Date(e)},c.prototype.setAccepted=function(e){void 0===e&&(e=!0),this.setInputValue(e)},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getMessage=function(){return this.getOutputByName("message","")},c.prototype.getMessageType=function(){return this.getOutputByName("messageType","")},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},c.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.isRequired=function(){return this.getOutputByName("required",!1)},c.prototype.setPassword=function(e){this.setInputValue(e)},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},c.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},c.prototype.isRequired=function(){return this.getOutputByName("required",!1)},c.prototype.setName=function(e){this.setInputValue(e)},c);function c(e){var t=a.call(this,e)||this;return t.payload=e,t}t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DB_NAME="forgerock-sdk";t.TOKEN_KEY="tokens"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOkOr4xx=function(e){return e.ok||4===Math.floor(e.status/100)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(n){void 0===n&&(n=15);var r=-1,o=0;if(n<4||15<n)throw new Error("Invalid nonce length");return function(){var e=Math.pow(10,2)*new Date;e===r?o++:(o=0,r=e);var t=(e+o).toString();return+t.substr(t.length-n)}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(5)),i=(a.getCurrentUser=function(){return o.default.getUserInfo()},a);function a(){}t.default=i},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11));t.Auth=i.default;var a=n(7);t.CallbackType=a.CallbackType,t.ErrorCode=a.ErrorCode;var u=r(n(1));t.Config=u.default;var s=r(n(13));t.Dispatcher=s.default;var c=r(n(14));t.FRAuth=c.default;var l=r(n(0));t.FRCallback=l.default;var f=r(n(20));t.AttributeInputCallback=f.default;var p=r(n(21));t.ChoiceCallback=p.default;var d=r(n(22));t.ConfirmationCallback=d.default;var h=r(n(23));t.DeviceProfileCallback=h.default;var y=r(n(24));t.HiddenValueCallback=y.default;var v=r(n(25));t.KbaCreateCallback=v.default;var b=r(n(26));t.MetadataCallback=b.default;var _=r(n(27));t.NameCallback=_.default;var g=r(n(28));t.PasswordCallback=g.default;var w=r(n(29));t.PollingWaitCallback=w.default;var m=r(n(30));t.ReCaptchaCallback=m.default;var O=r(n(31));t.TermsAndConditionsCallback=O.default;var P=r(n(32));t.TextOutputCallback=P.default;var C=r(n(33));t.ValidatedCreatePasswordCallback=C.default;var k=r(n(34));t.ValidatedCreateUsernameCallback=k.default;var T=n(3);t.StepType=T.StepType;var A=r(n(15));t.FRLoginFailure=A.default;var M=r(n(19));t.FRLoginSuccess=M.default;var E=r(n(8));t.FRStep=E.default;var S=r(n(46));t.FRDevice=S.default;var x=o(n(16));t.FRPolicy=x.default,t.PolicyKey=x.PolicyKey;var N=r(n(18));t.defaultMessageCreator=N.default;var j=r(n(49));t.FRUser=j.default;var I=o(n(53));t.FRWebAuthn=I.default,t.WebAuthnOutcome=I.WebAuthnOutcome,t.WebAuthnStepType=I.WebAuthnStepType;var R=r(n(56));t.HttpClient=R.default;var D=o(n(5));t.OAuth2Client=D.default,t.ResponseType=D.ResponseType;var U=r(n(58));t.SessionManager=U.default;var V=r(n(10));t.TokenManager=V.default;var B=r(n(6));t.TokenStorage=B.default;var L=r(n(38));t.UserManager=L.default;var K=r(n(59));t.Deferred=K.default;var F=r(n(37));t.nonce=F.default;var q=r(n(9));t.PKCE=q.default;var W=r(n(60));t.LocalStorage=W.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_TIMEOUT=6e4},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRealmUrlPath=function(e){var t=(e||"").split("/").map(function(e){return e.trim()}).filter(function(e){return""!==e});return"root"!==t[0]&&t.unshift("root"),t.map(function(e){return"realms/"+e}).join("/")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.add=function(e,t,n){e[t]=e[t]||[],e[t].indexOf(n)<0&&e[t].push(n)},t.remove=function(e,t,n){if(e[t]){var r=e[t].indexOf(n);0<=r&&e[t].splice(r,1)}},t.clear=function(t,n){Object.keys(t).forEach(function(e){n&&e!==n||delete t[e]})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.plural=function(e,t,n){return 1===e?t:void 0!==n?n:t+"s"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProp=function(e,t,n){return e&&void 0!==e[t]?e[t]:n}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(0)),i=n(7),a=r(n(20)),u=r(n(21)),s=r(n(22)),c=r(n(23)),l=r(n(24)),f=r(n(25)),p=r(n(26)),d=r(n(27)),h=r(n(28)),y=r(n(29)),v=r(n(30)),b=r(n(31)),_=r(n(32)),g=r(n(33)),w=r(n(34));t.default=function(e){switch(e.type){case i.CallbackType.BooleanAttributeInputCallback:return new a.default(e);case i.CallbackType.ChoiceCallback:return new u.default(e);case i.CallbackType.ConfirmationCallback:return new s.default(e);case i.CallbackType.DeviceProfileCallback:return new c.default(e);case i.CallbackType.HiddenValueCallback:return new l.default(e);case i.CallbackType.KbaCreateCallback:return new f.default(e);case i.CallbackType.MetadataCallback:return new p.default(e);case i.CallbackType.NameCallback:return new d.default(e);case i.CallbackType.PasswordCallback:return new h.default(e);case i.CallbackType.PollingWaitCallback:return new y.default(e);case i.CallbackType.ReCaptchaCallback:return new v.default(e);case i.CallbackType.StringAttributeInputCallback:return new a.default(e);case i.CallbackType.TermsAndConditionsCallback:return new b.default(e);case i.CallbackType.TextOutputCallback:return new _.default(e);case i.CallbackType.ValidatedCreatePasswordCallback:return new g.default(e);case i.CallbackType.ValidatedCreateUsernameCallback:return new w.default(e);default:return new o.default(e)}}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},u=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c,l=n(47),f=s(n(48)),p=(c=f.default,o(d,c),d.prototype.getBrowserMeta=function(){return navigator?this.reduceToObject(this.config.browserProps,navigator):(console.warn("Cannot collect browser metadata. navigator is not defined."),{})},d.prototype.getBrowserPluginsNames=function(){return navigator&&navigator.plugins?this.reduceToString(Object.keys(navigator.plugins),navigator.plugins):(console.warn("Cannot collect browser plugin information. navigator.plugins is not defined."),"")},d.prototype.getDeviceName=function(){if(!navigator)return console.warn("Cannot collect device name. navigator is not defined."),"";var e=navigator.userAgent,t=navigator.platform;switch(!0){case this.config.devicePlatforms.mac.includes(t):return"Mac (Browser)";case this.config.devicePlatforms.ios.includes(t):return t+" (Browser)";case this.config.devicePlatforms.windows.includes(t):return"Windows (Browser)";case/Android/.test(t)||/Android/.test(e):return"Android (Browser)";case/CrOS/.test(e)||/Chromebook/.test(e):return"Chrome OS (Browser)";case/Linux/.test(t):return"Linux (Browser)";default:return(t||"Unknown")+" (Browser)"}},d.prototype.getDisplayMeta=function(){return screen||console.warn("Cannot collect screen information. screen is not defined."),this.reduceToObject(this.config.displayProps,screen)},d.prototype.getHardwareMeta=function(){return navigator?this.reduceToObject(this.config.hardwareProps,navigator):(console.warn("Cannot collect OS metadata. Navigator is not defined."),{})},d.prototype.getIdentifier=function(){if(!window.crypto||!window.crypto.getRandomValues)return console.warn("Cannot generate profile ID. Crypto and/or getRandomValues is not supported."),"";if(!localStorage)return console.warn("Cannot store profile ID. localStorage is not supported."),"";var e=localStorage.getItem("profile-id");return e||(e=window.crypto.getRandomValues(new Uint32Array(3)).join("-"),localStorage.setItem("profile-id",e)),e},d.prototype.getInstalledFonts=function(){var e=document.createElement("canvas");if(!e)return console.warn("Cannot collect font data. Browser does not support canvas element"),"";var n=e.getContext&&e.getContext("2d");if(!n)return console.warn("Cannot collect font data. Browser does not support 2d canvas context"),"";var r="abcdefghi0123456789";n.font="72px Comic Sans";var o=n.measureText(r).width;return this.config.fontNames.reduce(function(e,t){return n.font="72px "+t+", Comic Sans",n.measureText(r).width!==o&&(e=""+e+t+";"),e},"")},d.prototype.getLocationCoordinates=function(){return a(this,void 0,void 0,function(){var n=this;return u(this,function(e){return navigator&&navigator.geolocation?[2,new Promise(function(t){return a(n,void 0,void 0,function(){return u(this,function(e){return navigator.geolocation.getCurrentPosition(function(e){return t({latitude:e.coords.latitude,longitude:e.coords.longitude})},function(e){console.warn("Cannot collect geolocation information. "+e.code+": "+e.message),t({})},{enableHighAccuracy:!0,timeout:l.delay,maximumAge:0}),[2]})})})]:(console.warn("Cannot collect geolocation information. navigator.geolocation is not defined."),[2,Promise.resolve({})])})})},d.prototype.getOSMeta=function(){return navigator?this.reduceToObject(this.config.platformProps,navigator):(console.warn("Cannot collect OS metadata. navigator is not defined."),{})},d.prototype.getProfile=function(e){var r=e.location,o=e.metadata;return a(this,void 0,void 0,function(){var t,n;return u(this,function(e){switch(e.label){case 0:return t={identifier:this.getIdentifier()},o&&(t.metadata={hardware:i(i({},this.getHardwareMeta()),{display:this.getDisplayMeta()}),browser:i(i({},this.getBrowserMeta()),{plugins:this.getBrowserPluginsNames()}),platform:i(i({},this.getOSMeta()),{deviceName:this.getDeviceName(),fonts:this.getInstalledFonts(),timezone:this.getTimezoneOffset()})}),r?(n=t,[4,this.getLocationCoordinates()]):[3,2];case 1:n.location=e.sent(),e.label=2;case 2:return[2,t]}})})},d.prototype.getTimezoneOffset=function(){try{return(new Date).getTimezoneOffset()}catch(e){return console.warn("Cannot collect timezone information. getTimezoneOffset is not defined."),null}},d);function d(t){var n=c.call(this)||this;return n.config={fontNames:l.fontNames,devicePlatforms:l.devicePlatforms,displayProps:l.displayProps,browserProps:l.browserProps,hardwareProps:l.hardwareProps,platformProps:l.platformProps},t&&Object.keys(t).forEach(function(e){if(!l.configurableCategories.includes(e))throw new Error("Device profile configuration category does not exist.");n.config[e]=t[e]}),n}t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.browserProps=["userAgent","appName","appCodeName","appVersion","appMinorVersion","buildID","product","productSub","vendor","vendorSub","browserLanguage"];t.configurableCategories=["fontNames","displayProps","browserProps","hardwareProps","platformProps"];t.delay=3e4;t.devicePlatforms={mac:["Macintosh","MacIntel","MacPPC","Mac68K"],windows:["Win32","Win64","Windows","WinCE"],ios:["iPhone","iPad","iPod"]};t.displayProps=["width","height","pixelDepth","orientation.angle"];t.fontNames=["cursive","monospace","serif","sans-serif","fantasy","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Bookman Old Style","Bradley Hand ITC","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Gentium","Impact","King","Lucida Console","Lalit","Modena","Monotype Corsiva","Papyrus","Tahoma","TeX","Times","Times New Roman","Trebuchet MS","Verdana","Verona"];t.hardwareProps=["cpuClass","deviceMemory","hardwareConcurrency","maxTouchPoints","oscpu"];t.platformProps=["language","platform","userLanguage","systemLanguage"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(o.prototype.reduceToObject=function(e,a){return e.reduce(function(e,t){if(t.includes(".")){var n=t.split("."),r=n[0],o=n[1],i=a[r]&&a[r][o];e[o]=null!=i?i:""}else e[t]=null!=a[t]?a[t]:null;return e},{})},o.prototype.reduceToString=function(e,n){return e.reduce(function(e,t){return e=""+e+n[t].filename+";"},"")},o);function o(){}t.default=r},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},o=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(5)),u=i(n(10)),s=i(n(38)),c=(l.login=function(t,n){return r(this,void 0,void 0,function(){return o(this,function(e){throw console.info(t,n),new Error("FRUser.login() not implemented")})})},l.loginWithUI=function(t,n){return r(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,t.getSession(n)];case 1:return e.sent(),[4,u.default.getTokens({forceRenew:!0})];case 2:return e.sent(),[4,s.default.getCurrentUser()];case 3:return[2,e.sent()];case 4:throw e.sent(),new Error("Login failed");case 5:return[2]}})})},l.logout=function(t){return r(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,a.default.endSession(t)];case 1:return e.sent(),[4,a.default.revokeToken(t)];case 2:return e.sent(),[4,u.default.deleteTokens()];case 3:return e.sent(),[3,5];case 4:throw e.sent(),new Error("Logout failed");case 5:return[2]}})})},l);function l(){}t.default=c},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},i=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n(35),o=(a.get=function(o){return r(this,void 0,void 0,function(){return i(this,function(e){return[2,new Promise(function(t,e){function n(){return e()}var r=window.indexedDB.open(l.DB_NAME);r.onsuccess=function(){if(!r.result.objectStoreNames.contains(o))return r.result.close(),t(void 0);var e=r.result.transaction(o,"readonly").objectStore(o).get(l.TOKEN_KEY);e.onsuccess=function(e){if(!e||!e.target)throw new Error("Missing storage event target");r.result.close(),t(e.target.result)},e.onerror=n},r.onupgradeneeded=function(){r.result.close(),t(void 0)},r.onerror=n})]})})},a.set=function(s,c){return r(this,void 0,void 0,function(){return i(this,function(e){return[2,new Promise(function(e,t){function r(){a.result.close(),e()}function o(){return t()}function i(){a.result.createObjectStore(s)}var a=window.indexedDB.open(l.DB_NAME),u=function(){if(!a.result.objectStoreNames.contains(s)){var e=a.result.version+1;return a.result.close(),(a=window.indexedDB.open(l.DB_NAME,e)).onupgradeneeded=i,a.onsuccess=u,void(a.onerror=o)}var t=a.result.transaction(s,"readwrite");t.onerror=o;var n=t.objectStore(s).put(c,l.TOKEN_KEY);n.onsuccess=r,n.onerror=o};a.onupgradeneeded=i,a.onsuccess=u,a.onerror=o})]})})},a.remove=function(o){return r(this,void 0,void 0,function(){return i(this,function(e){return[2,new Promise(function(t,e){function n(){return e()}var r=window.indexedDB.open(l.DB_NAME);r.onsuccess=function(){if(!r.result.objectStoreNames.contains(o))return t();var e=r.result.transaction(o,"readwrite").objectStore(o).delete(l.TOKEN_KEY);e.onsuccess=function(){t()},e.onerror=n},r.onerror=n})]})})},a);function a(){}t.default=o},function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},i=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(35),r=(u.get=function(n){return o(this,void 0,void 0,function(){var t;return i(this,function(e){t=localStorage.getItem(a.DB_NAME+"-"+n);try{return[2,Promise.resolve(JSON.parse(t||""))]}catch(e){return console.warn("Could not parse token from localStorage. This could be due to accessing a removed token"),[2,void 0]}return[2]})})},u.set=function(n,r){return o(this,void 0,void 0,function(){var t;return i(this,function(e){return t=JSON.stringify(r),localStorage.setItem(a.DB_NAME+"-"+n,t),[2]})})},u.remove=function(t){return o(this,void 0,void 0,function(){return i(this,function(e){return localStorage.removeItem(a.DB_NAME+"-"+t),[2]})})},u);function u(){}t.default=r},function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),(o=r=r||{}).Code="code",o.Token="token",t.ResponseType=r},function(e,t,n){"use strict";var d=this&&this.__assign||function(){return(d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},l=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),i=n(54);t.WebAuthnOutcome=i.WebAuthnOutcome,t.WebAuthnStepType=i.WebAuthnStepType;var h=n(55),a=(u.getWebAuthnStepType=function(e){var t=this.getOutcomeCallback(e),n=this.getMetadataCallback(e);return t&&n?n.getOutputValue("data").acceptableCredentials?i.WebAuthnStepType.Authentication:i.WebAuthnStepType.Registration:i.WebAuthnStepType.None},u.authenticate=function(c){return r(this,void 0,void 0,function(){var t,n,r,o,i,a,u,s;return l(this,function(e){switch(e.label){case 0:if(t=this.getCallbacks(c),n=t.hiddenCallback,r=t.metadataCallback,!n||!r)throw new Error("Invalid webauthn payload");e.label=1;case 1:return e.trys.push([1,3,,4]),i=r.getOutputValue("data"),a=this.createAuthenticationPublicKey(i),[4,this.getAuthenticationCredential(a)];case 2:return u=e.sent(),o=this.getAuthenticationOutcome(u),[3,4];case 3:return s=e.sent(),o=this.getErrorOutcome(s),[3,4];case 4:return n.setInputValue(o),[2,c]}})})},u.register=function(c){return r(this,void 0,void 0,function(){var t,n,r,o,i,a,u,s;return l(this,function(e){switch(e.label){case 0:if(t=this.getCallbacks(c),n=t.hiddenCallback,r=t.metadataCallback,!n||!r)throw new Error("Invalid webauthn payload");e.label=1;case 1:return e.trys.push([1,3,,4]),i=r.getOutputValue("data"),a=this.createRegistrationPublicKey(i),[4,this.getRegistrationCredential(a)];case 2:return u=e.sent(),o=this.getRegistrationOutcome(u),[3,4];case 3:return s=e.sent(),o=this.getErrorOutcome(s),[3,4];case 4:return n.setInputValue(o),[2,c]}})})},u.getCallbacks=function(e){return{hiddenCallback:this.getOutcomeCallback(e),metadataCallback:this.getMetadataCallback(e)}},u.getMetadataCallback=function(e){return e.getCallbacksOfType(o.CallbackType.MetadataCallback).find(function(e){var t=e.getOutputByName("data",void 0);return t&&t.hasOwnProperty("relyingPartyId")})},u.getOutcomeCallback=function(e){return e.getCallbacksOfType(o.CallbackType.HiddenValueCallback).find(function(e){return"webAuthnOutcome"===e.getOutputByName("id","")})},u.getAuthenticationCredential=function(t){return r(this,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,navigator.credentials.get({publicKey:t})];case 1:return[2,e.sent()]}})})},u.getAuthenticationOutcome=function(e){if(!window.PublicKeyCredential)return i.WebAuthnOutcome.Unsupported;try{if(null===e)throw new Error("No credential provided");var t=h.getClientDataJson(e),n=e.response;return t+"::"+new Int8Array(n.authenticatorData).toString()+"::"+new Int8Array(n.signature).toString()+"::"+e.id}catch(e){return this.getErrorOutcome(e)}},u.getRegistrationCredential=function(t){return r(this,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,navigator.credentials.create({publicKey:t})];case 1:return[2,e.sent()]}})})},u.getRegistrationOutcome=function(e){if(!window.PublicKeyCredential)return i.WebAuthnOutcome.Unsupported;try{if(null===e)throw new Error("No credential provided");var t=h.getClientDataJson(e),n=e.response;return t+"::"+new Int8Array(n.attestationObject).toString()+"::"+e.id}catch(e){return this.getErrorOutcome(e)}},u.createAuthenticationPublicKey=function(e){var t=e.acceptableCredentials,n=e.challenge,r=e.relyingPartyId,o=e.timeout,i=h.parseRelyingPartyId(r);return d({allowCredentials:h.parseCredentials(t),challenge:Uint8Array.from(atob(n),function(e){return e.charCodeAt(0)}).buffer,timeout:o},i&&{rpId:i})},u.createRegistrationPublicKey=function(e){var t=e.pubKeyCredParams,n=h.parsePubKeyArray(t);if(!n)throw new Error("Missing pubKeyCredParams");var r=e.attestationPreference,o=e.authenticatorSelection,i=e.challenge,a=e.relyingPartyId,u=e.relyingPartyName,s=e.timeout,c=e.userId,l=e.userName,f=h.parseRelyingPartyId(a),p=d({name:u},f&&{id:f});return{attestation:r,authenticatorSelection:JSON.parse(o),challenge:Uint8Array.from(atob(i),function(e){return e.charCodeAt(0)}).buffer,pubKeyCredParams:n,rp:p,timeout:s,user:{displayName:l,id:Int8Array.from(c.split("").map(function(e){return e.charCodeAt(0)})),name:l}}},u.getErrorOutcome=function(e){var t=e.name?e.name+":":"";return i.WebAuthnOutcome.Error+"::"+t+e.message},u);function u(){}t.default=a},function(e,t,n){"use strict";var r,o,i,a;Object.defineProperty(t,"__esModule",{value:!0}),(o=r=r||{}).Error="ERROR",o.Unsupported="unsupported",t.WebAuthnOutcome=r,(a=i=i||{})[a.None=0]="None",a[a.Authentication=1]="Authentication",a[a.Registration=2]="Registration",t.WebAuthnStepType=i},function(e,t,n){"use strict";function r(e){var t=/new Int8Array\((.+)\)/.exec(e);return null===t||t.length<2?[]:JSON.parse(t[1])}Object.defineProperty(t,"__esModule",{value:!0}),t.parsePubKeyArray=function(e){if(e){if(Array.isArray(e))return e;if("string"==typeof e)return 0<e.length&&"["===e[0]?JSON.parse(e):(e=e.replace(/(\w+):/g,'"$1":'),JSON.parse("["+e+"]"))}},t.parseNumberArray=r,t.parseCredentials=function(e){try{return e.split("}").filter(function(e){return!!e}).map(function(e){var t=r(e);return{id:new Int8Array(t).buffer,type:"public-key"}})}catch(e){throw new Error("Failed to parse credentials")}},t.getClientDataJson=function(e){var t=new Uint8Array(e.response.clientDataJSON);return String.fromCharCode.apply(null,Array.from(t))},t.parseRelyingPartyId=function(e){return e.replace(/rpId: "(.+)",/,"$1")}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},f=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,p=i(n(1)),u=i(n(13)),c=i(n(14)),l=n(3),d=i(n(8)),h=i(n(10)),y=i(n(6)),v=n(4),b=n(57),_=(a=u.default,o(g,a),g.request=function(l){return s(this,void 0,void 0,function(){var t,n,r,o,i,a,u,s,c;return f(this,function(e){switch(e.label){case 0:return[4,this._request(l,!1)];case 1:return t=e.sent(),b.newTokenRequired(t,l.requiresNewToken)?[4,this._request(l,!0)]:[3,3];case 2:t=e.sent(),e.label=3;case 3:return l.txnAuth&&l.txnAuth.handleStep?t.redirected&&b.examineForIGTxnAuth(t)?(n=b.normalizeIGJSON(t),[3,7]):[3,4]:[3,15];case 4:return[4,b.examineForRESTTxnAuth(t)];case 5:return e.sent()?[4,b.normalizeRESTJSON(t)]:[3,7];case 6:n=e.sent(),e.label=7;case 7:return n&&n.advices?(r=p.default.get(l.txnAuth.config),o=r.realmPath,i=r.serverConfig,a=b.buildTxnAuthOptions(n,i.baseUrl,l.timeout,o,i.paths),[4,this._request(a,!1)]):[3,15];case 8:return u=e.sent(),[4,b.isAuthStep(u)];case 9:if(!e.sent())throw new Error('Error: Initial response from auth server not a "step".');if(!b.hasTransactionAdvice(n))throw new Error("Error: TransactionConditionAdvice is empty.");e.label=10;case 10:return e.trys.push([10,14,,15]),[4,this.stepIterator(u,l.txnAuth.handleStep)];case 11:return e.sent(),[4,y.default.get()];case 12:return s=e.sent(),l.url=b.addTxnIDAndTokenToURL(l.url,n.advices,s),[4,this._request(l,!1)];case 13:return t=e.sent(),[3,15];case 14:throw c=e.sent(),new Error(c);case 15:return[2,t]}})})},g.setAuthHeaders=function(n,r){return s(this,void 0,void 0,function(){var t;return f(this,function(e){switch(e.label){case 0:return[4,y.default.get()];case 1:return(t=e.sent())&&t.accessToken?[4,h.default.getTokens({forceRenew:r})]:[3,3];case 2:t=e.sent(),n.set("Authorization","Bearer "+t.accessToken),e.label=3;case 3:return[2,n]}})})},g.stepIterator=function(o,u){return s(this,void 0,void 0,function(){var t,n,r=this;return f(this,function(e){switch(e.label){case 0:return[4,o.json()];case 1:return t=e.sent(),n=new d.default(t),[2,new Promise(function(i,a){return s(r,void 0,void 0,function(){return f(this,function(e){return function r(o){return s(this,void 0,void 0,function(){var t,n;return f(this,function(e){switch(e.label){case 0:return[4,u(o)];case 1:return t=e.sent(),[4,c.default.next(t)];case 2:return(n=e.sent()).type===l.StepType.LoginSuccess?i():n.type===l.StepType.LoginFailure?a("Transaction authorization failure."):r(n),[2]}})})}(n),[2]})})})]}})})},g._request=function(i,a){return s(this,void 0,void 0,function(){var t,n,r,o;return f(this,function(e){switch(e.label){case 0:return t=i.url,n=i.init,r=i.timeout,o=new Headers(n.headers),i.bypassAuthentication?[3,2]:[4,this.setAuthHeaders(o,a)];case 1:o=e.sent(),e.label=2;case 2:return n.headers=o,[4,v.withTimeout(fetch(t,n),r)];case 3:return[2,e.sent()]}})})},g);function g(){return null!==a&&a.apply(this,arguments)||this}t.default=_},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},o=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(2);t.addTxnIDAndTokenToURL=function(e,t,n){var r=t.TransactionConditionAdvice[0],o=new URL(e);return o.searchParams.append("_txid",r),n&&n.idToken&&o.searchParams.append("_idtoken",n.idToken),o.toString()},t.buildTxnAuthOptions=function(e,t,n,r,o){var i='<Advices><AttributeValuePair><Attribute name="TransactionConditionAdvice"/>'+("<Value>"+(e.advices?e.advices.TransactionConditionAdvice:[]).reduce(function(e,t){return e=""+t+(e?" "+e:e)},"")+"</Value>")+"</AttributeValuePair></Advices>",a=s.getEndpointPath("authenticate",r,o),u={authIndexType:"composite_advice",authIndexValue:i};return{init:{method:"POST",credentials:"include",headers:{"Accept-API-Version":"resource=2.0, protocol=1.0"}},timeout:n,url:s.resolve(t,a+"?"+s.stringify(u))}},t.examineForIGTxnAuth=function(e){return(e.headers.get("Content-Type")||"").includes("html")&&e.url.includes("composite_advice")},t.examineForRESTTxnAuth=function(t){return r(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,t.clone().json()];case 1:return[2,!!e.sent().advices]}})})},t.hasTransactionAdvice=function(e){return!!e.advices&&(Array.isArray(e.advices.TransactionConditionAdvice)&&0<e.advices.TransactionConditionAdvice.length)},t.isAuthStep=function(t){return r(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,t.clone().json()];case 1:return[2,!!e.sent().callbacks]}})})},t.newTokenRequired=function(e,t){return"function"==typeof t?t(e):401===e.status},t.normalizeIGJSON=function(e){return{resource:"",actions:{},attributes:{},advices:{TransactionConditionAdvice:[(t=e.url,n=new URL(t).searchParams.get("authIndexValue")||"",r=new DOMParser,o=decodeURIComponent(n),(i=r.parseFromString(o,"application/xml").querySelector("Value"))?i.innerHTML:"")]},ttl:0};var t,n,r,o,i},t.normalizeRESTJSON=function(t){return r(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,t.json()];case 1:return[2,e.sent()]}})})}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,a,u,s){return new(u=u||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})},c=this&&this.__generator||function(n,r){var o,i,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(1)),f=n(12),p=n(36),d=n(4),h=n(2),i=(a.logout=function(s){return r(this,void 0,void 0,function(){var t,n,r,o,i,a,u;return c(this,function(e){switch(e.label){case 0:return t=l.default.get(s),n=t.realmPath,r=t.serverConfig,o={credentials:"include",headers:{"accept-api-version":"protocol=1.0,resource=2.0","x-requested-with":f.REQUESTED_WITH},method:"POST"},i=h.getEndpointPath("sessions",n,r.paths)+"?_action=logout",a=h.resolve(r.baseUrl,i),[4,d.withTimeout(fetch(a,o),r.timeout)];case 1:if(u=e.sent(),!p.isOkOr4xx(u))throw new Error("Failed to log out; received "+u.status);return[2,u]}})})},a);function a(){}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(){var n=this;this.promise=new Promise(function(e,t){n.reject=t,n.resolve=e})}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(o.prototype.get=function(e){var t=this.storage.getItem(e);if(t)return JSON.parse(t)},o.prototype.set=function(e,t){this.storage.setItem(e,JSON.stringify(t))},o.prototype.remove=function(e){this.storage.removeItem(e)},o);function o(e){void 0===e&&(e=!1),this.storage=e?window.localStorage:window.sessionStorage}t.default=r}],o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=39);function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}var n,r});