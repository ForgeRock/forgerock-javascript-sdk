!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("forgerock",[],e):"object"==typeof exports?exports.forgerock=e():t.forgerock=e()}(window,function(){return r={},o.m=n=[function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(o.prototype.getType=function(){return this.payload.type},o.prototype.getInputValue=function(t){return void 0===t&&(t=0),this.getArrayElement(this.payload.input,t).value},o.prototype.setInputValue=function(t,e){void 0===e&&(e=0),this.getArrayElement(this.payload.input,e).value=t},o.prototype.getOutputValue=function(t){return void 0===t&&(t=0),this.getArrayElement(this.payload.output,t).value},o.prototype.getOutputByName=function(e,t){var n=this.payload.output.find(function(t){return t.name===e});return n?n.value:t},o.prototype.getArrayElement=function(t,e){if(void 0===e&&(e=0),void 0===t)throw new Error("No NameValue array was provided to search (selector "+e+")");if("number"==typeof e){if(e<0||e>t.length-1)throw new Error("Selector index "+e+" is out of range");return t[e]}if("string"!=typeof e)throw new Error("Invalid selector value type");var n=t.find(function(t){return t.name===e});if(!n)throw new Error('Missing callback input entry "'+e+'"');return n},o);function o(t){this.payload=t}e.default=r},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(40);e.DEFAULT_TIMEOUT=o.DEFAULT_TIMEOUT;var i=(a.set=function(t){if(!this.isValid(t))throw new Error("Configuration is invalid");t.serverConfig&&this.validateServerConfig(t.serverConfig),this.options=r({},t)},a.get=function(t){if(!this.options&&!t)throw new Error("Configuration has not been set");var e=r(r({},this.options),t);if(!e.serverConfig||!e.serverConfig.baseUrl)throw new Error("Server configuration has not been set");return e},a.isValid=function(t){return!(!t||!t.serverConfig)},a.validateServerConfig=function(t){t.timeout||(t.timeout=o.DEFAULT_TIMEOUT);var e=t.baseUrl;e&&"/"!==e.charAt(e.length-1)&&(t.baseUrl=e+"/")},a);function a(){}e.default=i},function(t,e,n){"use strict";var a=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};Object.defineProperty(e,"__esModule",{value:!0});var i=n(41);function u(t){var e="http:"===t.protocol&&-1===["","80"].indexOf(t.port)||"https:"===t.protocol&&-1===["","443"].indexOf(t.port)?":"+t.port:"";return t.protocol+"//"+t.hostname+e}e.getBaseUrl=u,e.getEndpointPath=function(t,e,n){var r=i.getRealmUrlPath(e),o={authenticate:"json/"+r+"/authenticate",authorize:"oauth2/"+r+"/authorize",accessToken:"oauth2/"+r+"/access_token",endSession:"oauth2/"+r+"/connect/endSession",userInfo:"oauth2/"+r+"/userinfo",revoke:"oauth2/"+r+"/token/revoke",sessions:"json/"+r+"/sessions/"};return n&&n[t]?n[t]:o[t]},e.resolve=function(t,e){var n=new URL(t);if(e.startsWith("/"))return""+u(n)+e;var r=n.pathname.split("/"),o=e.split("/").filter(function(t){return!!t}),i=a(r.slice(0,-1),o).join("/");return""+u(n)+i},e.parseQuery=function(t){var e=new URL(t),n={};return e.searchParams.forEach(function(t,e){return n[e]=t}),n},e.stringify=function(t){var e=[];for(var n in t)t[n]&&e.push(n+"="+encodeURIComponent(t[n]));return e.join("&")}},function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),(o=r=r||{}).LoginFailure="LoginFailure",o.LoginSuccess="LoginSuccess",o.Step="Step",e.StepType=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);e.withTimeout=function(t,e){void 0===e&&(e=r.DEFAULT_TIMEOUT);var n=e||r.DEFAULT_TIMEOUT;return Promise.race([t,new Promise(function(t,e){return window.setTimeout(function(){return e(new Error("Timeout"))},n)})])}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},p=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var d=o(n(1)),c=o(n(6)),a=n(36),f=o(n(9)),l=n(4),h=n(2),i=n(52);e.ResponseType=i.ResponseType;var u=(s.getAuthorizeUrl=function(l){return r(this,void 0,void 0,function(){var e,u,n,r,o,i,a,s,c=this;return p(this,function(t){switch(t.label){case 0:return e=d.default.get(l),u=e.serverConfig,n=e.clientId,r=e.redirectUri,o=e.scope,i={client_id:n,redirect_uri:r,response_type:l.responseType,scope:o,state:l.state},l.verifier?[4,f.default.createChallenge(l.verifier)]:[3,2];case 1:a=t.sent(),i.code_challenge=a,i.code_challenge_method="S256",t.label=2;case 2:return s=this.getUrl("authorize",i,l),[2,new Promise(function(e,t){function n(){}var r,o=document.createElement("iframe"),i=n,a=0;r=function(){window.clearTimeout(a),o.removeEventListener("load",i),o.remove()},i=function(){if(o.contentWindow){var t=o.contentWindow.location.href;c.containsAuthCode(t)&&(r(),e(t))}},a=window.setTimeout(function(){r(),t("Timeout")},u.timeout),o.style.display="none",o.addEventListener("load",i),document.body.appendChild(o),o.src=s})]}})})},s.getOAuth2Tokens=function(f){return r(this,void 0,void 0,function(){var e,n,r,o,i,a,u,s,c,l;return p(this,function(t){switch(t.label){case 0:return e=d.default.get(f),n=e.clientId,r=e.redirectUri,o={client_id:n,code:f.authorizationCode,grant_type:"authorization_code",redirect_uri:r},f.verifier&&(o.code_verifier=f.verifier),i=h.stringify(o),a={body:i,headers:{"content-length":i.length.toString(),"content-type":"application/x-www-form-urlencoded"},method:"POST"},[4,this.request("accessToken",void 0,!1,a,f)];case 1:return u=t.sent(),[4,this.getBody(u)];case 2:if(s=t.sent(),200!==u.status)throw c="string"==typeof s?"Expected 200, received "+u.status:this.parseError(s),new Error(c);if(!(l=s).access_token)throw new Error("Access token not found in response");return[2,{accessToken:l.access_token,idToken:l.id_token,refreshToken:l.refresh_token}]}})})},s.getUserInfo=function(n){return r(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return[4,this.request("userInfo",void 0,!0,void 0,n)];case 1:if(200!==(e=t.sent()).status)throw new Error("Failed to get user info; received "+e.status);return[4,e.json()];case 2:return[2,t.sent()]}})})},s.endSession=function(o){return r(this,void 0,void 0,function(){var e,n,r;return p(this,function(t){switch(t.label){case 0:return[4,c.default.get()];case 1:return e=t.sent().idToken,n={},e&&(n.id_token_hint=e),[4,this.request("endSession",n,!0,void 0,o)];case 2:if(r=t.sent(),!a.isOkOr4xx(r))throw new Error("Failed to end session; received "+r.status);return[2,r]}})})},s.revokeToken=function(i){return r(this,void 0,void 0,function(){var e,n,r,o;return p(this,function(t){switch(t.label){case 0:return e=d.default.get(i).clientId,[4,c.default.get()];case 1:return n=t.sent().accessToken,r={body:h.stringify({client_id:e,token:n}),credentials:"include",headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST"},[4,this.request("revoke",void 0,!1,r,i)];case 2:if(o=t.sent(),!a.isOkOr4xx(o))throw new Error("Failed to revoke token; received "+o.status);return[2,o]}})})},s.request=function(o,i,a,u,s){return r(this,void 0,void 0,function(){var e,n,r;return p(this,function(t){switch(t.label){case 0:return e=d.default.get(s).serverConfig,n=this.getUrl(o,i,s),u=u||{},a?[4,c.default.get()]:[3,2];case 1:r=t.sent().accessToken,u.credentials="include",u.headers=u.headers||new Headers,u.headers.set("authorization","Bearer "+r),t.label=2;case 2:return[4,l.withTimeout(fetch(n,u),e.timeout)];case 3:return[2,t.sent()]}})})},s.containsAuthCode=function(t){return!!t&&/code=([^&]+)/.test(t)},s.getBody=function(n){return r(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return(e=n.headers.get("content-type"))&&-1<e.indexOf("application/json")?[4,n.json()]:[3,2];case 1:return[2,t.sent()];case 2:return[4,n.text()];case 3:return[2,t.sent()]}})})},s.parseError=function(t){if(t){if(t.error&&t.error_description)return t.error+": "+t.error_description;if(t.code&&t.message)return t.code+": "+t.message}},s.getUrl=function(t,e,n){var r=d.default.get(n),o=r.realmPath,i=r.serverConfig,a=h.getEndpointPath(t,o,i.paths),u=h.resolve(i.baseUrl,a);return e&&(u+="?"+h.stringify(e)),u},s);function s(){}e.default=u},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},i=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=o(n(1)),u=o(n(50)),s=o(n(51)),c=(l.get=function(){return r(this,void 0,void 0,function(){var e,n,r;return i(this,function(t){switch(t.label){case 0:return e=this.getClientConfig(),n=e.clientId,"localStorage"!==(r=e.tokenStore)?[3,2]:[4,s.default.get(n)];case 1:return[2,t.sent()];case 2:return"indexedDB"!==r?[3,4]:[4,u.default.get(n)];case 3:return[2,t.sent()];case 4:return r&&r.get?[4,r.get(n)]:[3,6];case 5:return[2,t.sent()];case 6:return[4,u.default.get(n)];case 7:return[2,t.sent()]}})})},l.set=function(o){return r(this,void 0,void 0,function(){var e,n,r;return i(this,function(t){switch(t.label){case 0:return e=this.getClientConfig(),n=e.clientId,"localStorage"!==(r=e.tokenStore)?[3,2]:[4,s.default.set(n,o)];case 1:return[2,t.sent()];case 2:return"indexedDB"!==r?[3,4]:[4,u.default.set(n,o)];case 3:return[2,t.sent()];case 4:return r&&r.set?[4,r.set(n,o)]:[3,6];case 5:return[2,t.sent()];case 6:return[4,u.default.set(n,o)];case 7:return[2,t.sent()]}})})},l.remove=function(){return r(this,void 0,void 0,function(){var e,n,r;return i(this,function(t){switch(t.label){case 0:return e=this.getClientConfig(),n=e.clientId,"localStorage"!==(r=e.tokenStore)?[3,2]:[4,s.default.remove(n)];case 1:return[2,t.sent()];case 2:return"indexedDB"!==r?[3,4]:[4,u.default.remove(n)];case 3:return[2,t.sent()];case 4:return r&&r.remove?[4,r.remove(n)]:[3,6];case 5:return[2,t.sent()];case 6:return[4,u.default.remove(n)];case 7:return[2,t.sent()]}})})},l.getClientConfig=function(){var t=a.default.get(),e=t.clientId,n=t.tokenStore;if(!e)throw new Error("clientId is required to manage token storage");return{clientId:e,tokenStore:n}},l);function l(){}e.default=c},function(t,e,n){"use strict";var r,o,i,a;Object.defineProperty(e,"__esModule",{value:!0}),(o=r=r||{}).BadRequest="BAD_REQUEST",o.Timeout="TIMEOUT",o.Unauthorized="UNAUTHORIZED",o.Unknown="UNKNOWN",e.ErrorCode=r,(a=i=i||{}).BooleanAttributeInputCallback="BooleanAttributeInputCallback",a.ChoiceCallback="ChoiceCallback",a.ConfirmationCallback="ConfirmationCallback",a.DeviceProfileCallback="DeviceProfileCallback",a.HiddenValueCallback="HiddenValueCallback",a.KbaCreateCallback="KbaCreateCallback",a.MetadataCallback="MetadataCallback",a.NameCallback="NameCallback",a.PasswordCallback="PasswordCallback",a.PollingWaitCallback="PollingWaitCallback",a.ReCaptchaCallback="ReCaptchaCallback",a.StringAttributeInputCallback="StringAttributeInputCallback",a.TermsAndConditionsCallback="TermsAndConditionsCallback",a.TextOutputCallback="TextOutputCallback",a.ValidatedCreatePasswordCallback="ValidatedCreatePasswordCallback",a.ValidatedCreateUsernameCallback="ValidatedCreateUsernameCallback",e.CallbackType=i},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(45)),i=n(3),a=(u.prototype.getCallbackOfType=function(t){var e=this.getCallbacksOfType(t);if(1!==e.length)throw new Error('Expected 1 callback of type "'+t+'", but found '+e.length);return e[0]},u.prototype.getCallbacksOfType=function(e){return this.callbacks.filter(function(t){return t.getType()===e})},u.prototype.setCallbackValue=function(t,e){var n=this.getCallbacksOfType(t);if(1!==n.length)throw new Error('Expected 1 callback of type "'+t+'", but found '+n.length);n[0].setInputValue(e)},u.prototype.getDescription=function(){return this.payload.description},u.prototype.getHeader=function(){return this.payload.header},u.prototype.getStage=function(){return this.payload.stage},u.prototype.convertCallbacks=function(t,e){return t.map(function(t){return(e||o.default)(t)||o.default(t)})},u);function u(t,e){this.payload=t,this.type=i.StepType.Step,this.callbacks=[],t.callbacks&&(this.callbacks=this.convertCallbacks(t.callbacks,e))}e.default=a},function(t,e,n){"use strict";var o=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},i=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var r=(a.createVerifier=function(t){void 0===t&&(t=32);var e=new Uint8Array(t);return window.crypto.getRandomValues(e),this.base64UrlEncode(e)},a.createChallenge=function(n){return o(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return[4,this.sha256(n)];case 1:return e=t.sent(),[2,this.base64UrlEncode(e)]}})})},a.base64UrlEncode=function(t){var e=Array.prototype.slice.call(t);return window.btoa(String.fromCharCode.apply(null,e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},a.sha256=function(r){return o(this,void 0,void 0,function(){var e,n;return i(this,function(t){switch(t.label){case 0:return e=(new TextEncoder).encode(r),[4,window.crypto.subtle.digest("SHA-256",e)];case 1:return n=t.sent(),[2,new Uint8Array(n)]}})})},a);function a(){}e.default=r},function(t,e,n){"use strict";var p=this&&this.__assign||function(){return(p=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},r=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},d=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var h=o(n(5)),y=i(n(6)),v=i(n(37)),b=i(n(9)),_=n(2),a=(u.getTokens=function(f){return r(this,void 0,void 0,function(){var e,n,r,o,i,a,u,s,c,l;return d(this,function(t){switch(t.label){case 0:if(f&&f.forceRenew)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,y.default.get()];case 2:return(e=t.sent())?[2,e]:[3,4];case 3:return n=t.sent(),console.error("Failed to retrieve stored tokens",n),[3,4];case 4:return r=b.default.createVerifier(),o=v.default()().toString(),i=p(p({},f),{responseType:h.ResponseType.Code,state:o,verifier:r}),[4,h.default.getAuthorizeUrl(i)];case 5:if(a=t.sent(),(u=_.parseQuery(a)).state!==o)throw new Error("State mismatch");if(!u.code||Array.isArray(u.code))throw new Error("Failed to acquire authorization code");return s=u.code,c=p(p({},f),{authorizationCode:s,verifier:r}),[4,h.default.getOAuth2Tokens(c)];case 6:e=t.sent(),t.label=7;case 7:return t.trys.push([7,9,,10]),[4,y.default.set(e)];case 8:return t.sent(),[3,10];case 9:return l=t.sent(),console.error("Failed to store tokens",l),[3,10];case 10:return[2,e]}})})},u.deleteTokens=function(){return r(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,y.default.remove()];case 1:return t.sent(),[2]}})})},u);function u(){}e.default=a},function(t,e,n){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},f=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var p=r(n(1)),i=n(12),d=n(4),c=n(2),a=(u.next=function(c,l){return o(this,void 0,void 0,function(){var e,n,r,o,i,a,u,s;return f(this,function(t){switch(t.label){case 0:return e=p.default.get(l),n=e.realmPath,r=e.serverConfig,o=e.tree,i=l?l.query:{},a=this.constructUrl(r,n,o,i),u=this.configureRequest(c),[4,d.withTimeout(fetch(a,u),r.timeout)];case 1:return s=t.sent(),[4,this.getResponseJson(s)];case 2:return[2,t.sent()]}})})},u.constructUrl=function(t,e,n,r){var o=n?{authIndexType:"service",authIndexValue:n}:void 0,i=s(s({},r),o),a=0<Object.keys(i).length?"?"+c.stringify(i):"",u=c.getEndpointPath("authenticate",e,t.paths);return c.resolve(t.baseUrl,u+a)},u.configureRequest=function(t){return{body:t?JSON.stringify(t):void 0,credentials:"include",headers:{accept:"application/json","accept-api-version":"protocol=1.0,resource=2.1","content-type":"application/json","x-requested-with":i.REQUESTED_WITH},method:"POST"}},u.getResponseJson=function(r){return o(this,void 0,void 0,function(){var e,n;return f(this,function(t){switch(t.label){case 0:return(e=r.headers.get("content-type"))&&-1<e.indexOf("application/json")?[4,r.json()]:[3,2];case 1:return n=t.sent(),[3,3];case 2:n=void 0,t.label=3;case 3:return[2,n]}})})},u);function u(){}e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.REQUESTED_WITH="forgerock-sdk"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(42),o=(i.prototype.addEventListener=function(t,e){r.add(this.callbacks,t,e)},i.prototype.removeEventListener=function(t,e){r.remove(this.callbacks,t,e)},i.prototype.clearEventListeners=function(t){r.clear(this.callbacks,t)},i.prototype.dispatchEvent=function(t){if(this.callbacks[t.type])for(var e=0,n=this.callbacks[t.type];e<n.length;e++)(0,n[e])(t)},i);function i(){this.callbacks={}}e.default=o},function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},a=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u=r(n(11)),s=r(n(15)),c=r(n(19)),l=r(n(8)),o=(f.next=function(r,o){return i(this,void 0,void 0,function(){var e,n;return a(this,function(t){switch(t.label){case 0:return[4,u.default.next(r?r.payload:void 0,o)];case 1:return(e=t.sent()).tokenId?[2,new c.default(e)]:e.authId?(n=o?o.callbackFactory:void 0,[2,new l.default(e,n)]):[2,new s.default(e)]}})})},f);function f(){}e.default=o},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(16)),i=n(3),a=(u.prototype.getCode=function(){return Number(this.payload.code)},u.prototype.getDetail=function(){return this.payload.detail},u.prototype.getMessage=function(){return this.payload.message},u.prototype.getProcessedMessage=function(t){return o.default.parseErrors(this.payload,t)},u.prototype.getReason=function(){return this.payload.reason},u);function u(t){this.payload=t,this.type=i.StepType.LoginFailure}e.default=a},function(t,e,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(17);e.PolicyKey=a.PolicyKey;var u=r(n(18)),o=(s.parseErrors=function(t,e){var n=this,r=[];return t.detail&&t.detail.failedPolicyRequirements&&t.detail.failedPolicyRequirements.map(function(t){r.push.apply(r,[{detail:t,messages:n.parseFailedPolicyRequirement(t,e)}])}),r},s.parseFailedPolicyRequirement=function(e,n){var r=this,o=[];return e.policyRequirements.map(function(t){o.push(r.parsePolicyRequirement(e.property,t,n))}),o},s.parsePolicyRequirement=function(t,e,n){void 0===n&&(n={});var r="string"==typeof e?JSON.parse(e):i({},e),o=r.policyRequirement;return(n[o]||u.default[o]||u.default[a.PolicyKey.UnknownPolicy])(t,r.params?i(i({},r.params),{policyRequirement:o}):{policyRequirement:o})},s);function s(){}e.default=o},function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),(o=r=r||{}).CannotContainCharacters="CANNOT_CONTAIN_CHARACTERS",o.CannotContainDuplicates="CANNOT_CONTAIN_DUPLICATES",o.CannotContainOthers="CANNOT_CONTAIN_OTHERS",o.LeastCapitalLetters="AT_LEAST_X_CAPITAL_LETTERS",o.LeastNumbers="AT_LEAST_X_NUMBERS",o.MatchRegexp="MATCH_REGEXP",o.MaximumLength="MAX_LENGTH",o.MaximumNumber="MAXIMUM_NUMBER_VALUE",o.MinimumLength="MIN_LENGTH",o.MinimumNumber="MINIMUM_NUMBER_VALUE",o.Required="REQUIRED",o.Unique="UNIQUE",o.UnknownPolicy="UNKNOWN_POLICY",o.ValidArrayItems="VALID_ARRAY_ITEMS",o.ValidDate="VALID_DATE",o.ValidEmailAddress="VALID_EMAIL_ADDRESS_FORMAT",o.ValidNameFormat="VALID_NAME_FORMAT",o.ValidNumber="VALID_NUMBER",o.ValidPhoneFormat="VALID_PHONE_FORMAT",o.ValidQueryFilter="VALID_QUERY_FILTER",o.ValidType="VALID_TYPE",e.PolicyKey=r},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0});var o=n(43),i=n(17),a=n(44),u=((r={})[i.PolicyKey.CannotContainCharacters]=function(t,e){return t+' must not contain following characters: "'+a.getProp(e,"forbiddenChars","")+'"'},r[i.PolicyKey.CannotContainDuplicates]=function(t,e){return t+'  must not contain duplicates: "'+a.getProp(e,"duplicateValue","")+'"'},r[i.PolicyKey.CannotContainOthers]=function(t,e){return t+' must not contain: "'+a.getProp(e,"disallowedFields","")+'"'},r[i.PolicyKey.LeastCapitalLetters]=function(t,e){var n=a.getProp(e,"numCaps",0);return t+" must contain at least "+n+" capital "+o.plural(n,"letter")},r[i.PolicyKey.LeastNumbers]=function(t,e){var n=a.getProp(e,"numNums",0);return t+" must contain at least "+n+" numeric "+o.plural(n,"value")},r[i.PolicyKey.MatchRegexp]=function(t){return t+' has failed the "MATCH_REGEXP" policy'},r[i.PolicyKey.MaximumLength]=function(t,e){var n=a.getProp(e,"maxLength",0);return t+" must be at most "+n+" "+o.plural(n,"character")},r[i.PolicyKey.MaximumNumber]=function(t){return t+' has failed the "MAXIMUM_NUMBER_VALUE" policy'},r[i.PolicyKey.MinimumLength]=function(t,e){var n=a.getProp(e,"minLength",0);return t+" must be at least "+n+" "+o.plural(n,"character")},r[i.PolicyKey.MinimumNumber]=function(t){return t+' has failed the "MINIMUM_NUMBER_VALUE" policy'},r[i.PolicyKey.Required]=function(t){return t+" is required"},r[i.PolicyKey.Unique]=function(t){return t+" must be unique"},r[i.PolicyKey.UnknownPolicy]=function(t,e){return t+': Unknown policy requirement "'+a.getProp(e,"policyRequirement","Unknown")+'"'},r[i.PolicyKey.ValidArrayItems]=function(t){return t+' has failed the "VALID_ARRAY_ITEMS" policy'},r[i.PolicyKey.ValidDate]=function(t){return t+" has an invalid date"},r[i.PolicyKey.ValidEmailAddress]=function(t){return t+" has an invalid email address"},r[i.PolicyKey.ValidNameFormat]=function(t){return t+" has an invalid name format"},r[i.PolicyKey.ValidNumber]=function(t){return t+" has an invalid number"},r[i.PolicyKey.ValidPhoneFormat]=function(t){return t+" has an invalid phone number"},r[i.PolicyKey.ValidQueryFilter]=function(t){return t+' has failed the "VALID_QUERY_FILTER" policy'},r[i.PolicyKey.ValidType]=function(t){return t+' has failed the "VALID_TYPE" policy'},r);e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),o=(i.prototype.getRealm=function(){return this.payload.realm},i.prototype.getSessionToken=function(){return this.payload.tokenId},i.prototype.getSuccessUrl=function(){return this.payload.successUrl},i);function i(t){this.payload=t,this.type=r.StepType.LoginSuccess}e.default=o},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getName=function(){return this.getOutputByName("name","")},c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.isRequired=function(){return this.getOutputByName("required",!1)},c.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},c.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},c.prototype.setValue=function(t){this.setInputValue(t)},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.getDefaultChoice=function(){return this.getOutputByName("defaultChoice",0)},c.prototype.getChoices=function(){return this.getOutputByName("choices",[])},c.prototype.setChoiceIndex=function(t){var e=this.getChoices().length;if(t<0||e-1<t)throw new Error(t+" is out of bounds");this.setInputValue(t)},c.prototype.setChoiceValue=function(t){var e=this.getChoices().indexOf(t);if(-1===e)throw new Error('"'+t+'" is not a valid choice');this.setInputValue(e)},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getDefaultOption=function(){return Number(this.getOutputByName("defaultOption",0))},c.prototype.getMessageType=function(){return Number(this.getOutputByName("messageType",0))},c.prototype.getOptions=function(){return this.getOutputByName("options",[])},c.prototype.getOptionType=function(){return Number(this.getOutputByName("optionType",0))},c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getMessage=function(){return this.getOutputByName("message","")},c.prototype.isMetadataRequired=function(){return this.getOutputByName("metadata",!1)},c.prototype.isLocationRequired=function(){return this.getOutputByName("location",!1)},c.prototype.setProfile=function(t){this.setInputValue(JSON.stringify(t))},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.getPredefinedQuestions=function(){return this.getOutputByName("predefinedQuestions",[])},c.prototype.setQuestion=function(t){this.setValue("question",t)},c.prototype.setAnswer=function(t){this.setValue("answer",t)},c.prototype.setValue=function(e,t){if(!this.payload.input)throw new Error("KBA payload is missing input");var n=this.payload.input.find(function(t){return t.name.endsWith(e)});if(!n)throw new Error('No input has name ending in "'+e+'"');n.value=t},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getData=function(){return this.getOutputByName("data",{})},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.setName=function(t){this.setInputValue(t)},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},c.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.setPassword=function(t){this.setInputValue(t)},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getMessage=function(){return this.getOutputByName("message","")},c.prototype.getWaitTime=function(){return Number(this.getOutputByName("waitTime",0))},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getSiteKey=function(){return this.getOutputByName("recaptchaSiteKey","")},c.prototype.setResult=function(t){this.setInputValue(t)},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getTerms=function(){return this.getOutputByName("terms","")},c.prototype.getVersion=function(){return this.getOutputByName("version","")},c.prototype.getCreateDate=function(){var t=this.getOutputByName("createDate","");return new Date(t)},c.prototype.setAccepted=function(t){void 0===t&&(t=!0),this.setInputValue(t)},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getMessage=function(){return this.getOutputByName("message","")},c.prototype.getMessageType=function(){return this.getOutputByName("messageType","")},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},c.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.isRequired=function(){return this.getOutputByName("required",!1)},c.prototype.setPassword=function(t){this.setInputValue(t)},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u=i(n(0)),s=(a=u.default,o(c,a),c.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},c.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},c.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},c.prototype.isRequired=function(){return this.getOutputByName("required",!1)},c.prototype.setName=function(t){this.setInputValue(t)},c);function c(t){var e=a.call(this,t)||this;return e.payload=t,e}e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.DB_NAME="forgerock-sdk";e.TOKEN_KEY="tokens"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isOkOr4xx=function(t){return t.ok||4===Math.floor(t.status/100)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(n){void 0===n&&(n=15);var r=-1,o=0;if(n<4||15<n)throw new Error("Invalid nonce length");return function(){var t=Math.pow(10,2)*new Date;t===r?o++:(o=0,r=t);var e=(t+o).toString();return+e.substr(e.length-n)}}},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(5)),i=(a.getCurrentUser=function(){return o.default.getUserInfo()},a);function a(){}e.default=i},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(11));e.Auth=i.default;var a=n(7);e.CallbackType=a.CallbackType,e.ErrorCode=a.ErrorCode;var u=r(n(1));e.Config=u.default;var s=r(n(13));e.Dispatcher=s.default;var c=r(n(14));e.FRAuth=c.default;var l=r(n(0));e.FRCallback=l.default;var f=r(n(20));e.AttributeInputCallback=f.default;var p=r(n(21));e.ChoiceCallback=p.default;var d=r(n(22));e.ConfirmationCallback=d.default;var h=r(n(23));e.DeviceProfileCallback=h.default;var y=r(n(24));e.HiddenValueCallback=y.default;var v=r(n(25));e.KbaCreateCallback=v.default;var b=r(n(26));e.MetadataCallback=b.default;var _=r(n(27));e.NameCallback=_.default;var g=r(n(28));e.PasswordCallback=g.default;var w=r(n(29));e.PollingWaitCallback=w.default;var m=r(n(30));e.ReCaptchaCallback=m.default;var O=r(n(31));e.TermsAndConditionsCallback=O.default;var P=r(n(32));e.TextOutputCallback=P.default;var C=r(n(33));e.ValidatedCreatePasswordCallback=C.default;var k=r(n(34));e.ValidatedCreateUsernameCallback=k.default;var T=n(3);e.StepType=T.StepType;var A=r(n(15));e.FRLoginFailure=A.default;var M=r(n(19));e.FRLoginSuccess=M.default;var x=r(n(8));e.FRStep=x.default;var E=r(n(46));e.FRDevice=E.default;var S=o(n(16));e.FRPolicy=S.default,e.PolicyKey=S.PolicyKey;var N=r(n(18));e.defaultMessageCreator=N.default;var j=r(n(49));e.FRUser=j.default;var I=o(n(53));e.FRWebAuthn=I.default,e.WebAuthnOutcome=I.WebAuthnOutcome,e.WebAuthnStepType=I.WebAuthnStepType;var R=r(n(56));e.HttpClient=R.default;var D=o(n(5));e.OAuth2Client=D.default,e.ResponseType=D.ResponseType;var U=r(n(58));e.SessionManager=U.default;var V=r(n(10));e.TokenManager=V.default;var B=r(n(6));e.TokenStorage=B.default;var L=r(n(38));e.UserManager=L.default;var K=r(n(59));e.Deferred=K.default;var F=r(n(37));e.nonce=F.default;var q=r(n(9));e.PKCE=q.default;var W=r(n(60));e.LocalStorage=W.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.DEFAULT_TIMEOUT=6e4},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getRealmUrlPath=function(t){var e=(t||"").split("/").map(function(t){return t.trim()}).filter(function(t){return""!==t});return"root"!==e[0]&&e.unshift("root"),e.map(function(t){return"realms/"+t}).join("/")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.add=function(t,e,n){t[e]=t[e]||[],t[e].indexOf(n)<0&&t[e].push(n)},e.remove=function(t,e,n){if(t[e]){var r=t[e].indexOf(n);0<=r&&t[e].splice(r,1)}},e.clear=function(e,n){Object.keys(e).forEach(function(t){n&&t!==n||delete e[t]})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.plural=function(t,e,n){return 1===t?e:void 0!==n?n:e+"s"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getProp=function(t,e,n){return t&&void 0!==t[e]?t[e]:n}},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(0)),i=n(7),a=r(n(20)),u=r(n(21)),s=r(n(22)),c=r(n(23)),l=r(n(24)),f=r(n(25)),p=r(n(26)),d=r(n(27)),h=r(n(28)),y=r(n(29)),v=r(n(30)),b=r(n(31)),_=r(n(32)),g=r(n(33)),w=r(n(34));e.default=function(t){switch(t.type){case i.CallbackType.BooleanAttributeInputCallback:return new a.default(t);case i.CallbackType.ChoiceCallback:return new u.default(t);case i.CallbackType.ConfirmationCallback:return new s.default(t);case i.CallbackType.DeviceProfileCallback:return new c.default(t);case i.CallbackType.HiddenValueCallback:return new l.default(t);case i.CallbackType.KbaCreateCallback:return new f.default(t);case i.CallbackType.MetadataCallback:return new p.default(t);case i.CallbackType.NameCallback:return new d.default(t);case i.CallbackType.PasswordCallback:return new h.default(t);case i.CallbackType.PollingWaitCallback:return new y.default(t);case i.CallbackType.ReCaptchaCallback:return new v.default(t);case i.CallbackType.StringAttributeInputCallback:return new a.default(t);case i.CallbackType.TermsAndConditionsCallback:return new b.default(t);case i.CallbackType.TextOutputCallback:return new _.default(t);case i.CallbackType.ValidatedCreatePasswordCallback:return new g.default(t);case i.CallbackType.ValidatedCreateUsernameCallback:return new w.default(t);default:return new o.default(t)}}},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},a=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},u=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var c,l=n(47),f=s(n(48)),p=(c=f.default,o(d,c),d.prototype.getBrowserMeta=function(){return navigator?this.reduceToObject(this.config.browserProps,navigator):(console.warn("Cannot collect browser metadata. navigator is not defined."),{})},d.prototype.getBrowserPluginsNames=function(){return navigator&&navigator.plugins?this.reduceToString(Object.keys(navigator.plugins),navigator.plugins):(console.warn("Cannot collect browser plugin information. navigator.plugins is not defined."),"")},d.prototype.getDeviceName=function(){if(!navigator)return console.warn("Cannot collect device name. navigator is not defined."),"";var t=navigator.userAgent,e=navigator.platform;switch(!0){case-1!==this.config.devicePlatforms.mac.indexOf(e):return"Mac (Browser)";case-1!==this.config.devicePlatforms.ios.indexOf(e):return e+" (Browser)";case-1!==this.config.devicePlatforms.windows.indexOf(e):return"Windows (Browser)";case/Android/.test(e)||/Android/.test(t):return"Android (Browser)";case/CrOS/.test(t)||/Chromebook/.test(t):return"Chrome OS (Browser)";case/Linux/.test(e):return"Linux (Browser)";default:return(e||"Unknown")+" (Browser)"}},d.prototype.getDisplayMeta=function(){return screen||console.warn("Cannot collect screen information. screen is not defined."),this.reduceToObject(this.config.displayProps,screen)},d.prototype.getHardwareMeta=function(){return navigator?this.reduceToObject(this.config.hardwareProps,navigator):(console.warn("Cannot collect OS metadata. Navigator is not defined."),{})},d.prototype.getIdentifier=function(){if(!window.crypto||!window.crypto.getRandomValues)return console.warn("Cannot generate profile ID. Crypto and/or getRandomValues is not supported."),"";if(!localStorage)return console.warn("Cannot store profile ID. localStorage is not supported."),"";var t=localStorage.getItem("profile-id");return t||(t=window.crypto.getRandomValues(new Uint32Array(3)).join("-"),localStorage.setItem("profile-id",t)),t},d.prototype.getInstalledFonts=function(){var t=document.createElement("canvas");if(!t)return console.warn("Cannot collect font data. Browser does not support canvas element"),"";var n=t.getContext&&t.getContext("2d");if(!n)return console.warn("Cannot collect font data. Browser does not support 2d canvas context"),"";var r="abcdefghi0123456789";n.font="72px Comic Sans";var o=n.measureText(r).width;return this.config.fontNames.reduce(function(t,e){return n.font="72px "+e+", Comic Sans",n.measureText(r).width!==o&&(t=""+t+e+";"),t},"")},d.prototype.getLocationCoordinates=function(){return a(this,void 0,void 0,function(){var n=this;return u(this,function(t){return navigator&&navigator.geolocation?[2,new Promise(function(e){return a(n,void 0,void 0,function(){return u(this,function(t){return navigator.geolocation.getCurrentPosition(function(t){return e({latitude:t.coords.latitude,longitude:t.coords.longitude})},function(t){console.warn("Cannot collect geolocation information. "+t.code+": "+t.message),e({})},{enableHighAccuracy:!0,timeout:l.delay,maximumAge:0}),[2]})})})]:(console.warn("Cannot collect geolocation information. navigator.geolocation is not defined."),[2,Promise.resolve({})])})})},d.prototype.getOSMeta=function(){return navigator?this.reduceToObject(this.config.platformProps,navigator):(console.warn("Cannot collect OS metadata. navigator is not defined."),{})},d.prototype.getProfile=function(t){var r=t.location,o=t.metadata;return a(this,void 0,void 0,function(){var e,n;return u(this,function(t){switch(t.label){case 0:return e={identifier:this.getIdentifier()},o&&(e.metadata={hardware:i(i({},this.getHardwareMeta()),{display:this.getDisplayMeta()}),browser:i(i({},this.getBrowserMeta()),{plugins:this.getBrowserPluginsNames()}),platform:i(i({},this.getOSMeta()),{deviceName:this.getDeviceName(),fonts:this.getInstalledFonts(),timezone:this.getTimezoneOffset()})}),r?(n=e,[4,this.getLocationCoordinates()]):[3,2];case 1:n.location=t.sent(),t.label=2;case 2:return[2,e]}})})},d.prototype.getTimezoneOffset=function(){try{return(new Date).getTimezoneOffset()}catch(t){return console.warn("Cannot collect timezone information. getTimezoneOffset is not defined."),null}},d);function d(e){var n=c.call(this)||this;return n.config={fontNames:l.fontNames,devicePlatforms:l.devicePlatforms,displayProps:l.displayProps,browserProps:l.browserProps,hardwareProps:l.hardwareProps,platformProps:l.platformProps},e&&Object.keys(e).forEach(function(t){if(!l.configurableCategories.includes(t))throw new Error("Device profile configuration category does not exist.");n.config[t]=e[t]}),n}e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.browserProps=["userAgent","appName","appCodeName","appVersion","appMinorVersion","buildID","product","productSub","vendor","vendorSub","browserLanguage"];e.configurableCategories=["fontNames","displayProps","browserProps","hardwareProps","platformProps"];e.delay=3e4;e.devicePlatforms={mac:["Macintosh","MacIntel","MacPPC","Mac68K"],windows:["Win32","Win64","Windows","WinCE"],ios:["iPhone","iPad","iPod"]};e.displayProps=["width","height","pixelDepth","orientation.angle"];e.fontNames=["cursive","monospace","serif","sans-serif","fantasy","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Bookman Old Style","Bradley Hand ITC","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Gentium","Impact","King","Lucida Console","Lalit","Modena","Monotype Corsiva","Papyrus","Tahoma","TeX","Times","Times New Roman","Trebuchet MS","Verdana","Verona"];e.hardwareProps=["cpuClass","deviceMemory","hardwareConcurrency","maxTouchPoints","oscpu"];e.platformProps=["language","platform","userLanguage","systemLanguage"]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(o.prototype.reduceToObject=function(t,o){return t.reduce(function(t,e){if(e.includes(".")){var n=e.split("."),r=o[n[0]]&&o[n[0]][n[1]];t[n[1]]=null!=r?r:""}else t[e]=null!=o[e]?o[e]:null;return t},{})},o.prototype.reduceToString=function(t,n){return t.reduce(function(t,e){return t=""+t+n[e].filename+";"},"")},o);function o(){}e.default=r},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},o=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(5)),u=i(n(10)),s=i(n(38)),c=(l.login=function(e,n){return r(this,void 0,void 0,function(){return o(this,function(t){throw console.info(e,n),new Error("FRUser.login() not implemented")})})},l.loginWithUI=function(e,n){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,e.getSession(n)];case 1:return t.sent(),[4,u.default.getTokens({forceRenew:!0})];case 2:return t.sent(),[4,s.default.getCurrentUser()];case 3:return[2,t.sent()];case 4:throw t.sent(),new Error("Login failed");case 5:return[2]}})})},l.logout=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,a.default.endSession(e)];case 1:return t.sent(),[4,a.default.revokeToken(e)];case 2:return t.sent(),[4,u.default.deleteTokens()];case 3:return t.sent(),[3,5];case 4:throw t.sent(),new Error("Logout failed");case 5:return[2]}})})},l);function l(){}e.default=c},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},i=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var l=n(35),o=(a.get=function(o){return r(this,void 0,void 0,function(){return i(this,function(t){return[2,new Promise(function(e,t){function n(){return t()}var r=window.indexedDB.open(l.DB_NAME);r.onsuccess=function(){if(!r.result.objectStoreNames.contains(o))return r.result.close(),e(void 0);var t=r.result.transaction(o,"readonly").objectStore(o).get(l.TOKEN_KEY);t.onsuccess=function(t){if(!t||!t.target)throw new Error("Missing storage event target");r.result.close(),e(t.target.result)},t.onerror=n},r.onupgradeneeded=function(){r.result.close(),e(void 0)},r.onerror=n})]})})},a.set=function(s,c){return r(this,void 0,void 0,function(){return i(this,function(t){return[2,new Promise(function(t,e){function r(){a.result.close(),t()}function o(){return e()}function i(){a.result.createObjectStore(s)}var a=window.indexedDB.open(l.DB_NAME),u=function(){if(!a.result.objectStoreNames.contains(s)){var t=a.result.version+1;return a.result.close(),(a=window.indexedDB.open(l.DB_NAME,t)).onupgradeneeded=i,a.onsuccess=u,void(a.onerror=o)}var e=a.result.transaction(s,"readwrite");e.onerror=o;var n=e.objectStore(s).put(c,l.TOKEN_KEY);n.onsuccess=r,n.onerror=o};a.onupgradeneeded=i,a.onsuccess=u,a.onerror=o})]})})},a.remove=function(o){return r(this,void 0,void 0,function(){return i(this,function(t){return[2,new Promise(function(e,t){function n(){return t()}var r=window.indexedDB.open(l.DB_NAME);r.onsuccess=function(){if(!r.result.objectStoreNames.contains(o))return e();var t=r.result.transaction(o,"readwrite").objectStore(o).delete(l.TOKEN_KEY);t.onsuccess=function(){e()},t.onerror=n},r.onerror=n})]})})},a);function a(){}e.default=o},function(t,e,n){"use strict";var o=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},i=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(35),r=(u.get=function(n){return o(this,void 0,void 0,function(){var e;return i(this,function(t){e=localStorage.getItem(a.DB_NAME+"-"+n);try{return[2,Promise.resolve(JSON.parse(e||""))]}catch(t){return console.warn("Could not parse token from localStorage. This could be due to accessing a removed token"),[2,void 0]}return[2]})})},u.set=function(n,r){return o(this,void 0,void 0,function(){var e;return i(this,function(t){return e=JSON.stringify(r),localStorage.setItem(a.DB_NAME+"-"+n,e),[2]})})},u.remove=function(e){return o(this,void 0,void 0,function(){return i(this,function(t){return localStorage.removeItem(a.DB_NAME+"-"+e),[2]})})},u);function u(){}e.default=r},function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),(o=r=r||{}).Code="code",o.Token="token",e.ResponseType=r},function(t,e,n){"use strict";var d=this&&this.__assign||function(){return(d=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},r=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},l=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(7),i=n(54);e.WebAuthnOutcome=i.WebAuthnOutcome,e.WebAuthnStepType=i.WebAuthnStepType;var h=n(55),a=(u.getWebAuthnStepType=function(t){var e=this.getOutcomeCallback(t),n=this.getMetadataCallback(t);return e&&n?n.getOutputValue("data").acceptableCredentials?i.WebAuthnStepType.Authentication:i.WebAuthnStepType.Registration:i.WebAuthnStepType.None},u.authenticate=function(c){return r(this,void 0,void 0,function(){var e,n,r,o,i,a,u,s;return l(this,function(t){switch(t.label){case 0:if(e=this.getCallbacks(c),n=e.hiddenCallback,r=e.metadataCallback,!n||!r)throw new Error("Invalid webauthn payload");t.label=1;case 1:return t.trys.push([1,3,,4]),i=r.getOutputValue("data"),a=this.createAuthenticationPublicKey(i),[4,this.getAuthenticationCredential(a)];case 2:return u=t.sent(),o=this.getAuthenticationOutcome(u),[3,4];case 3:return s=t.sent(),o=this.getErrorOutcome(s),[3,4];case 4:return n.setInputValue(o),[2,c]}})})},u.register=function(c){return r(this,void 0,void 0,function(){var e,n,r,o,i,a,u,s;return l(this,function(t){switch(t.label){case 0:if(e=this.getCallbacks(c),n=e.hiddenCallback,r=e.metadataCallback,!n||!r)throw new Error("Invalid webauthn payload");t.label=1;case 1:return t.trys.push([1,3,,4]),i=r.getOutputValue("data"),a=this.createRegistrationPublicKey(i),[4,this.getRegistrationCredential(a)];case 2:return u=t.sent(),o=this.getRegistrationOutcome(u),[3,4];case 3:return s=t.sent(),o=this.getErrorOutcome(s),[3,4];case 4:return n.setInputValue(o),[2,c]}})})},u.getCallbacks=function(t){return{hiddenCallback:this.getOutcomeCallback(t),metadataCallback:this.getMetadataCallback(t)}},u.getMetadataCallback=function(t){return t.getCallbacksOfType(o.CallbackType.MetadataCallback).find(function(t){var e=t.getOutputByName("data",void 0);return e&&e.hasOwnProperty("relyingPartyId")})},u.getOutcomeCallback=function(t){return t.getCallbacksOfType(o.CallbackType.HiddenValueCallback).find(function(t){return"webAuthnOutcome"===t.getOutputByName("id","")})},u.getAuthenticationCredential=function(e){return r(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,navigator.credentials.get({publicKey:e})];case 1:return[2,t.sent()]}})})},u.getAuthenticationOutcome=function(t){if(!window.PublicKeyCredential)return i.WebAuthnOutcome.Unsupported;try{if(null===t)throw new Error("No credential provided");var e=h.getClientDataJson(t),n=t.response;return e+"::"+new Int8Array(n.authenticatorData).toString()+"::"+new Int8Array(n.signature).toString()+"::"+t.id}catch(t){return this.getErrorOutcome(t)}},u.getRegistrationCredential=function(e){return r(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,navigator.credentials.create({publicKey:e})];case 1:return[2,t.sent()]}})})},u.getRegistrationOutcome=function(t){if(!window.PublicKeyCredential)return i.WebAuthnOutcome.Unsupported;try{if(null===t)throw new Error("No credential provided");var e=h.getClientDataJson(t),n=t.response;return e+"::"+new Int8Array(n.attestationObject).toString()+"::"+t.id}catch(t){return this.getErrorOutcome(t)}},u.createAuthenticationPublicKey=function(t){var e=t.acceptableCredentials,n=t.challenge,r=t.relyingPartyId,o=t.timeout,i=h.parseRelyingPartyId(r);return d({allowCredentials:h.parseCredentials(e),challenge:Uint8Array.from(atob(n),function(t){return t.charCodeAt(0)}).buffer,timeout:o},i&&{rpId:i})},u.createRegistrationPublicKey=function(t){var e=t.pubKeyCredParams,n=h.parsePubKeyArray(e);if(!n)throw new Error("Missing pubKeyCredParams");var r=t.attestationPreference,o=t.authenticatorSelection,i=t.challenge,a=t.relyingPartyId,u=t.relyingPartyName,s=t.timeout,c=t.userId,l=t.userName,f=h.parseRelyingPartyId(a),p=d({name:u},f&&{id:f});return{attestation:r,authenticatorSelection:JSON.parse(o),challenge:Uint8Array.from(atob(i),function(t){return t.charCodeAt(0)}).buffer,pubKeyCredParams:n,rp:p,timeout:s,user:{displayName:l,id:Int8Array.from(c.split("").map(function(t){return t.charCodeAt(0)})),name:l}}},u.getErrorOutcome=function(t){var e=t.name?t.name+":":"";return i.WebAuthnOutcome.Error+"::"+e+t.message},u);function u(){}e.default=a},function(t,e,n){"use strict";var r,o,i,a;Object.defineProperty(e,"__esModule",{value:!0}),(o=r=r||{}).Error="ERROR",o.Unsupported="unsupported",e.WebAuthnOutcome=r,(a=i=i||{})[a.None=0]="None",a[a.Authentication=1]="Authentication",a[a.Registration=2]="Registration",e.WebAuthnStepType=i},function(t,e,n){"use strict";function r(t){var e=/new Int8Array\((.+)\)/.exec(t);return null===e||e.length<2?[]:JSON.parse(e[1])}Object.defineProperty(e,"__esModule",{value:!0}),e.parsePubKeyArray=function(t){if(t){if(Array.isArray(t))return t;if("string"==typeof t)return 0<t.length&&"["===t[0]?JSON.parse(t):(t=t.replace(/(\w+):/g,'"$1":'),JSON.parse("["+t+"]"))}},e.parseNumberArray=r,e.parseCredentials=function(t){try{return t.split("}").filter(function(t){return!!t}).map(function(t){var e=r(t);return{id:new Int8Array(e).buffer,type:"public-key"}})}catch(t){throw new Error("Failed to parse credentials")}},e.getClientDataJson=function(t){var e=new Uint8Array(t.response.clientDataJSON);return String.fromCharCode.apply(null,Array.from(e))},e.parseRelyingPartyId=function(t){return t.replace(/rpId: "(.+)",/,"$1")}},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},l=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,f=i(n(1)),u=i(n(13)),c=i(n(14)),p=n(3),d=i(n(8)),h=i(n(10)),y=i(n(6)),v=n(4),b=n(57),_=(a=u.default,o(g,a),g.request=function(c){return s(this,void 0,void 0,function(){var e,n,r,o,i,a,u,s;return l(this,function(t){switch(t.label){case 0:return[4,this._request(c,!1)];case 1:return e=t.sent(),b.newTokenRequired(e,c.requiresNewToken)?[4,this._request(c,!0)]:[3,3];case 2:e=t.sent(),t.label=3;case 3:return c.txnAuth&&c.txnAuth.handleStep?e.redirected&&b.examineForIGTxnAuth(e)?(n=b.normalizeIGJSON(e),[3,7]):[3,4]:[3,14];case 4:return[4,b.examineForRESTTxnAuth(e)];case 5:return t.sent()?[4,b.normalizeRESTJSON(e)]:[3,7];case 6:n=t.sent(),t.label=7;case 7:return n&&n.advices?(r=f.default.get(c.txnAuth.config),o=r.realmPath,i=r.serverConfig,a=b.buildTxnAuthOptions(n,i.baseUrl,c.timeout,o,i.paths),[4,this._request(a,!1)]):[3,14];case 8:return u=t.sent(),[4,b.isAuthStep(u)];case 9:if(!t.sent())throw new Error('Error: Initial response from auth server not a "step".');if(!b.hasTransactionAdvice(n))throw new Error("Error: TransactionConditionAdvice is empty.");t.label=10;case 10:return t.trys.push([10,13,,14]),[4,this.stepIterator(u,c.txnAuth.handleStep)];case 11:return t.sent(),c.txnAuth.txnID=n.advices.TransactionConditionAdvice[0],[4,this._request(c,!1)];case 12:return e=t.sent(),[3,14];case 13:throw s=t.sent(),new Error(s);case 14:return[2,e]}})})},g.setAuthHeaders=function(r,o,i){return s(this,void 0,void 0,function(){var e,n;return l(this,function(t){switch(t.label){case 0:return e=o.txnAuth&&o.txnAuth.handleStep,[4,y.default.get()];case 1:return(n=t.sent()).accessToken?[4,h.default.getTokens({forceRenew:i})]:[3,3];case 2:return n=t.sent(),r.set("Authorization","Bearer "+n.accessToken),e&&(r.set("X-Id-Token",n.idToken||""),r.set("X-Txn-Id",o.txnAuth&&o.txnAuth.txnID||"")),[3,4];case 3:e&&r.set("X-Txn-Id",o.txnAuth&&o.txnAuth.txnID||""),t.label=4;case 4:return[2,r]}})})},g.stepIterator=function(o,u){return s(this,void 0,void 0,function(){var e,n,r=this;return l(this,function(t){switch(t.label){case 0:return[4,o.json()];case 1:return e=t.sent(),n=new d.default(e),[2,new Promise(function(i,a){return s(r,void 0,void 0,function(){return l(this,function(t){return function r(o){return s(this,void 0,void 0,function(){var e,n;return l(this,function(t){switch(t.label){case 0:return[4,u(o)];case 1:return e=t.sent(),[4,c.default.next(e)];case 2:return(n=t.sent()).type===p.StepType.LoginSuccess?i():n.type===p.StepType.LoginFailure?a("Transaction authorization failure."):r(n),[2]}})})}(n),[2]})})})]}})})},g._request=function(i,a){return s(this,void 0,void 0,function(){var e,n,r,o;return l(this,function(t){switch(t.label){case 0:return e=i.url,n=i.init,r=i.timeout,o=new Headers(n.headers),i.bypassAuthentication?[3,2]:[4,this.setAuthHeaders(o,i,a)];case 1:o=t.sent(),t.label=2;case 2:return n.headers=o,[4,v.withTimeout(fetch(e,n),r)];case 3:return[2,t.sent()]}})})},g);function g(){return null!==a&&a.apply(this,arguments)||this}e.default=_},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},o=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(2);e.buildTxnAuthOptions=function(t,e,n,r,o){var i='<Advices><AttributeValuePair><Attribute name="TransactionConditionAdvice"/>'+("<Value>"+(t.advices?t.advices.TransactionConditionAdvice:[]).reduce(function(t,e){return t=""+e+(t?" "+t:t)},"")+"</Value>")+"</AttributeValuePair></Advices>",a=s.getEndpointPath("authenticate",r,o),u={authIndexType:"composite_advice",authIndexValue:i};return{init:{method:"POST",credentials:"include"},timeout:n,url:s.resolve(e,a+"?"+s.stringify(u))}},e.examineForIGTxnAuth=function(t){return(t.headers.get("Content-Type")||"").includes("html")&&t.url.includes("composite_advice")},e.examineForRESTTxnAuth=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,e.clone().json()];case 1:return[2,!!t.sent().advices]}})})},e.hasTransactionAdvice=function(t){return!!t.advices&&(Array.isArray(t.advices.TransactionConditionAdvice)&&0<t.advices.TransactionConditionAdvice.length)},e.isAuthStep=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,e.clone().json()];case 1:return[2,!!t.sent().callbacks]}})})},e.newTokenRequired=function(t,e){return"function"==typeof e?e(t):401===t.status},e.normalizeIGJSON=function(t){return{resource:"",actions:{},attributes:{},advices:{TransactionConditionAdvice:[(e=t.url,n=new URL(e).searchParams.get("authIndexValue")||"",r=new DOMParser,o=decodeURIComponent(n),(i=r.parseFromString(o,"application/xml").querySelector("Value"))?i.innerHTML:"")]},ttl:0};var e,n,r,o,i},e.normalizeRESTJSON=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,e.json()];case 1:return[2,t.sent()]}})})}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},c=this&&this.__generator||function(n,r){var o,i,a,t,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var l=o(n(1)),f=n(12),p=n(36),d=n(4),h=n(2),i=(a.logout=function(s){return r(this,void 0,void 0,function(){var e,n,r,o,i,a,u;return c(this,function(t){switch(t.label){case 0:return e=l.default.get(s),n=e.realmPath,r=e.serverConfig,o={credentials:"include",headers:{"accept-api-version":"protocol=1.0,resource=2.0","x-requested-with":f.REQUESTED_WITH},method:"POST"},i=h.getEndpointPath("sessions",n,r.paths)+"?_action=logout",a=h.resolve(r.baseUrl,i),[4,d.withTimeout(fetch(a,o),r.timeout)];case 1:if(u=t.sent(),!p.isOkOr4xx(u))throw new Error("Failed to log out; received "+u.status);return[2,u]}})})},a);function a(){}e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});function r(){var n=this;this.promise=new Promise(function(t,e){n.reject=e,n.resolve=t})}e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(o.prototype.get=function(t){var e=this.storage.getItem(t);if(e)return JSON.parse(e)},o.prototype.set=function(t,e){this.storage.setItem(t,JSON.stringify(e))},o.prototype.remove=function(t){this.storage.removeItem(t)},o);function o(t){void 0===t&&(t=!1),this.storage=t?window.localStorage:window.sessionStorage}e.default=r}],o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=39);function o(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}var n,r});